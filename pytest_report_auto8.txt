============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.3.5, pluggy-1.5.0 -- /Applications/Xcode.app/Contents/Developer/usr/bin/python3
cachedir: .pytest_cache
rootdir: /Users/xuyehua/Code/remote-terminal-mcp
plugins: anyio-4.9.0, cov-6.1.1, asyncio-1.0.0
asyncio: mode=strict, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 208 items

python/tests/config_manager/test_io.py::TestConfigIO::test_dummy PASSED  [  0%]
python/tests/tool_connect_server/test_connection_manager_integration.py::test_integration_imports PASSED [  0%]
python/tests/tool_connect_server/test_connection_manager_integration.py::test_manager_creation PASSED [  1%]
python/tests/tool_connect_server/test_connection_manager_integration.py::test_api_backward_compatibility PASSED [  1%]
python/tests/tool_connect_server/test_connection_manager_integration.py::test_mcp_server_compatibility PASSED [  2%]
python/tests/tool_connect_server/test_connection_manager_integration.py::test_simple_mode_parameter PASSED [  2%]
python/tests/tool_connect_server/test_end_to_end.py::test_environment PASSED [  3%]
python/tests/tool_connect_server/test_end_to_end.py::TestEndToEndWorkflow::test_complete_server_setup_workflow PASSED [  3%]
python/tests/tool_connect_server/test_end_to_end.py::TestEndToEndWorkflow::test_docker_setup_workflow PASSED [  4%]
python/tests/tool_connect_server/test_end_to_end.py::TestEndToEndWorkflow::test_mcp_integration_workflow PASSED [  4%]
python/tests/tool_connect_server/test_end_to_end.py::TestUserScenarios::test_configuration_migration_scenario PASSED [  5%]
python/tests/tool_connect_server/test_end_to_end.py::TestUserScenarios::test_multiple_servers_scenario PASSED [  5%]
python/tests/tool_connect_server/test_end_to_end.py::TestUserScenarios::test_new_user_setup_scenario PASSED [  6%]
python/tests/tool_connect_server/test_end_to_end.py::TestErrorHandling::test_invalid_config_handling PASSED [  6%]
python/tests/tool_connect_server/test_end_to_end.py::TestErrorHandling::test_permission_error_handling PASSED [  7%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_applescript_terminal_cleanup_integration PASSED [  7%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_complete_applescript_sequence PASSED [  8%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_complete_expect_sequence PASSED [  8%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_comprehensive_test_with_process_management PASSED [  9%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_error_handling_in_process_management PASSED [  9%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_process_cleanup_functionality PASSED [ 10%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_process_tracking_mechanism PASSED [ 10%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_remaining_process_detection PASSED [ 11%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_temp_file_cleanup_integration PASSED [ 11%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_terminal_cleanup_functionality PASSED [ 12%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestCompleteInteractionAndProcessManagement::test_timeout_handling_in_interactions PASSED [ 12%]
python/tests/tool_connect_server/test_fix_complete_interaction_and_process_management_20241222.py::TestInteractionSequenceCompleteness::test_all_required_interaction_steps PASSED [ 12%]
python/tests/tool_connect_server/test_fix_interactive_interface_startup_20241222.py::TestInteractiveInterfaceStartupFix::test_automated_interaction_compatibility PASSED [ 13%]
python/tests/tool_connect_server/test_fix_interactive_interface_startup_20241222.py::TestInteractiveInterfaceStartupFix::test_create_server_config_response_format PASSED [ 13%]
python/tests/tool_connect_server/test_fix_interactive_interface_startup_20241222.py::TestInteractiveInterfaceStartupFix::test_manual_command_execution PASSED [ 14%]
python/tests/tool_connect_server/test_fix_interactive_interface_startup_20241222.py::TestInteractiveInterfaceStartupFix::test_no_background_process_started PASSED [ 14%]
python/tests/tool_connect_server/test_fix_interactive_interface_startup_20241222.py::TestInteractiveInterfaceStartupFix::test_response_consistency PASSED [ 15%]
python/tests/tool_connect_server/test_fix_interactive_interface_startup_20241222.py::TestInteractiveInterfaceStartupFix::test_user_guidance_completeness PASSED [ 15%]
python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py::TestInteractiveStartupRequirement::test_create_server_config_must_start_interactive_interface FAILED [ 16%]
python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py::TestInteractiveStartupRequirement::test_interactive_startup_failure_diagnosis FAILED [ 16%]
python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py::TestInteractiveStartupRequirement::test_interactive_startup_with_minimal_params FAILED [ 17%]
python/tests/tool_connect_server/test_fix_mcp_timeout_issue_20240622.py::TestMCPTimeoutFix::test_reproduce_timeout_issue PASSED [ 17%]
python/tests/tool_connect_server/test_fix_mcp_timeout_issue_20240622.py::TestMCPTimeoutFix::test_verify_timeout_mechanism PASSED [ 18%]
python/tests/tool_connect_server/test_fix_mcp_timeout_issue_20240622.py::TestMCPTimeoutFix::test_timeout_parameter_validation PASSED [ 18%]
python/tests/tool_connect_server/test_fix_mcp_timeout_issue_20240622.py::TestMCPTimeoutFix::test_process_cleanup_after_timeout PASSED [ 19%]
python/tests/tool_connect_server/test_fix_mcp_timeout_issue_20240622.py::TestMCPTimeoutFix::test_normal_operation_with_timeout PASSED [ 19%]
python/tests/tool_connect_server/test_fix_mcp_timeout_issue_20240622.py::TestMCPTimeoutFix::test_different_tools_timeout_behavior PASSED [ 20%]
python/tests/tool_connect_server/test_fix_mcp_timeout_issue_20240622.py::TestMCPTimeoutFix::test_timeout_fix_documentation PASSED [ 20%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIUsageCompliance::test_code_examples_in_documentation PASSED [ 21%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIUsageCompliance::test_correct_relay_cli_usage PASSED [ 21%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIUsageCompliance::test_edge_cases PASSED [ 22%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIUsageCompliance::test_forbidden_relay_cli_usage PASSED [ 22%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIUsageCompliance::test_parse_relay_cli_command PASSED [ 23%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIUsageCompliance::test_rule_documentation_compliance PASSED [ 23%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIRegressionPrevention::test_correct_usage_still_works PASSED [ 24%]
python/tests/tool_connect_server/test_fix_relay_cli_usage_20250105.py::TestRelayCLIRegressionPrevention::test_prevent_command_parameter_regression PASSED [ 24%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionLogicFix::test_all_fixes_integration PASSED [ 25%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionLogicFix::test_command_execution_enhanced PASSED [ 25%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionLogicFix::test_connection_detection_enhanced PASSED [ 25%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionLogicFix::test_connection_error_logging_enhanced PASSED [ 26%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionLogicFix::test_interactive_guide_relay_patterns PASSED [ 26%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionLogicFix::test_relay_authentication_handler_added PASSED [ 27%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionLogicFix::test_relay_cli_usage_compliance PASSED [ 27%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionSpecific::test_relay_authentication_success_detection PASSED [ 28%]
python/tests/tool_connect_server/test_fix_relay_connection_logic_20250105.py::TestRelayConnectionSpecific::test_relay_authentication_timeout_handling PASSED [ 28%]
python/tests/tool_connect_server/test_fix_tj09_server_creation_20240622.py::TJ09ServerCreationTest::test_tj09_connection_type PASSED [ 29%]
python/tests/tool_connect_server/test_fix_tj09_server_creation_20240622.py::TJ09ServerCreationTest::test_tj09_docker_config PASSED [ 29%]
python/tests/tool_connect_server/test_fix_tj09_server_creation_20240622.py::TJ09ServerCreationTest::test_tj09_server_config PASSED [ 30%]
python/tests/tool_connect_server/test_fix_tj09_server_creation_20240622.py::TJ09ServerCreationTest::test_tj09_server_exists PASSED [ 30%]
python/tests/tool_connect_server/test_fix_tj09_server_creation_20240622.py::TJ09ServerCreationTest::test_tj09_status_check PASSED [ 31%]
python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py::TestUserVisibleInteraction::test_background_process_detection PASSED [ 31%]
python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py::TestUserVisibleInteraction::test_interactive_interface_accessibility FAILED [ 32%]
python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py::TestUserVisibleInteraction::test_process_output_visibility PASSED [ 32%]
python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py::TestUserVisibleInteraction::test_terminal_window_creation_on_macos FAILED [ 33%]
python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_guided_setup_docker_server_full_automation FAILED [ 33%]
python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_guided_setup_relay_server_full_automation FAILED [ 34%]
python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_guided_setup_ssh_server_full_automation FAILED [ 34%]
python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_main_menu_automation PASSED [ 35%]
python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_smart_input_error_recovery_automation FAILED [ 35%]
python/tests/tool_connect_server/test_fully_automated_interactive.py::TestInputValidationAutomation::test_hostname_validation_automation FAILED [ 36%]
python/tests/tool_connect_server/test_fully_automated_interactive.py::TestInputValidationAutomation::test_port_validation_automation FAILED [ 36%]
python/tests/tool_connect_server/test_mcp_tools.py::TestMCPTools::test_config_file_operations PASSED [ 37%]
python/tests/tool_connect_server/test_mcp_tools.py::TestMCPTools::test_config_manager_tools PASSED [ 37%]
python/tests/tool_connect_server/test_mcp_tools.py::TestMCPTools::test_docker_command_generation PASSED [ 37%]
python/tests/tool_connect_server/test_mcp_tools.py::TestMCPTools::test_docker_config_tools PASSED [ 38%]
python/tests/tool_connect_server/test_mcp_tools.py::TestMCPTools::test_mcp_server_import PASSED [ 38%]
python/tests/tool_connect_server/test_mcp_tools.py::TestMCPTools::test_mcp_tool_availability PASSED [ 39%]
python/tests/tool_connect_server/test_mcp_tools.py::TestMCPTools::test_server_config_creation PASSED [ 39%]
python/tests/tool_connect_server/test_mcp_tools.py::TestConfigurationConsistency::test_config_directory_consistency FAILED [ 40%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_dependencies_installable PASSED [ 40%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_main_entry_file FAILED [ 41%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_package_json_exists PASSED [ 41%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_package_json_structure PASSED [ 42%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_required_python_files FAILED [ 42%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_scripts_configuration PASSED [ 43%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageInstallation::test_npm_pack_success FAILED [ 43%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageInstallation::test_package_size_reasonable PASSED [ 44%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackagePublishing::test_npm_publish_dry_run PASSED [ 44%]
python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackagePublishing::test_version_consistency PASSED [ 45%]
python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationRegression::test_config_directory_consistency PASSED [ 45%]
python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationRegression::test_config_file_structure PASSED [ 46%]
python/tests/tool_connect_server/test_regression_prevention.py::TestMCPToolsRegression::test_interactive_wizard_functionality PASSED [ 46%]
python/tests/tool_connect_server/test_regression_prevention.py::TestMCPToolsRegression::test_mcp_tools_availability PASSED [ 47%]
python/tests/tool_connect_server/test_regression_prevention.py::TestDockerConfigRegression::test_docker_command_completeness PASSED [ 47%]
python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_ensure_config_exists_preserves_user_config FAILED [ 48%]
python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_get_existing_servers_preserves_user_modifications FAILED [ 48%]
python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_modified_example_server_detection FAILED [ 49%]
python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_npm_installation_protection FAILED [ 49%]
python/tests/tool_connect_server/test_regression_prevention.py::TestUserExperienceRegression::test_configuration_backup PASSED [ 50%]
python/tests/tool_connect_server/test_regression_prevention.py::TestUserExperienceRegression::test_error_messages_quality PASSED [ 50%]
python/tests/tool_connect_server/test_regression_prevention.py::TestAPIConsistency::test_docker_config_manager_api PASSED [ 50%]
python/tests/tool_connect_server/test_regression_prevention.py::TestAPIConsistency::test_enhanced_config_manager_api PASSED [ 51%]
python/tests/tool_connect_server/test_simple_automated_demo.py::TestSimpleAutomationDemo::test_mcp_guided_setup_automation PASSED [ 51%]
python/tests/tool_connect_server/test_simple_automated_demo.py::TestSimpleAutomationDemo::test_multiple_validation_types FAILED [ 52%]
python/tests/tool_connect_server/test_simple_automated_demo.py::TestSimpleAutomationDemo::test_smart_input_basic_automation FAILED [ 52%]
python/tests/tool_connect_server/test_simple_automated_demo.py::TestSimpleAutomationDemo::test_smart_input_error_recovery_automation FAILED [ 53%]
python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_batch_server_creation FAILED [ 53%]
python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_completely_headless_operation FAILED [ 54%]
python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_completely_silent_mcp_setup FAILED [ 54%]
python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_mock_all_interactions_completely FAILED [ 55%]
python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_smart_input_with_defaults FAILED [ 55%]
python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_validation_with_auto_retry FAILED [ 56%]
python/tests/utils/test_helpers.py::test_environment PASSED              [ 56%]
test_enhanced_list.py::test_enhanced_list PASSED                         [ 57%]
test_interactive_config.py::test_force_interactive FAILED                [ 57%]
test_shell_config.py::test_bash_config PASSED                            [ 58%]
test_shell_config.py::test_zsh_config PASSED                             [ 58%]
test_shell_config.py::test_server_configs PASSED                         [ 59%]
tests/tool_add_server_config/test_docker_config.py::TestDockerConfigCollector::test_configure_docker_skip PASSED [ 59%]
tests/tool_add_server_config/test_fix_config_auto_creation_removal_20241222.py::TestConfigAutoCreationRemoval::test_config_directory_creation PASSED [ 60%]
tests/tool_add_server_config/test_fix_config_auto_creation_removal_20241222.py::TestConfigAutoCreationRemoval::test_ensure_config_exists_no_auto_creation PASSED [ 60%]
tests/tool_add_server_config/test_fix_config_auto_creation_removal_20241222.py::TestConfigAutoCreationRemoval::test_ensure_config_exists_with_invalid_config PASSED [ 61%]
tests/tool_add_server_config/test_fix_config_auto_creation_removal_20241222.py::TestConfigAutoCreationRemoval::test_ensure_config_exists_with_valid_config PASSED [ 61%]
tests/tool_add_server_config/test_fix_config_auto_creation_removal_20241222.py::TestConfigAutoCreationRemoval::test_ensure_config_exists_with_yaml_error PASSED [ 62%]
tests/tool_add_server_config/test_fix_config_auto_creation_removal_20241222.py::TestConfigAutoCreationRemoval::test_get_existing_servers_no_config PASSED [ 62%]
tests/tool_add_server_config/test_fix_config_auto_creation_removal_20241222.py::TestConfigAutoCreationRemoval::test_mcp_mode_behavior PASSED [ 62%]
tests/tool_add_server_config/test_fix_save_config_parameter_mismatch_20250615.py::TestSaveConfigParameterFix::test_regression_server_deletion_scenario PASSED [ 63%]
tests/tool_add_server_config/test_fix_save_config_parameter_mismatch_20250615.py::TestSaveConfigParameterFix::test_save_config_parameter_name_consistency PASSED [ 63%]
tests/tool_add_server_config/test_fix_save_config_parameter_mismatch_20250615.py::TestSaveConfigParameterFix::test_save_config_with_merge_false PASSED [ 64%]
tests/tool_add_server_config/test_fix_save_config_parameter_mismatch_20250615.py::TestSaveConfigParameterFix::test_save_config_with_merge_parameter PASSED [ 64%]
tests/tool_add_server_config/test_interaction.py::TestUserInteraction::test_colored_print PASSED [ 65%]
tests/tool_add_server_config/test_interaction.py::TestUserInteraction::test_smart_input_default PASSED [ 65%]
tests/tool_add_server_config/test_interaction.py::TestUserInteraction::test_smart_input_with_mock PASSED [ 66%]
tests/tool_add_server_config/test_interactive_create_server_config.py::test_interactive_create_server_config FAILED [ 66%]
tests/tool_add_server_config/test_interactive_create_server_config_prefill.py::test_interactive_create_server_config_prefill FAILED [ 67%]
tests/tool_add_server_config/test_io.py::TestConfigIO::test_save_and_load_config PASSED [ 67%]
tests/tool_delete_server_config/test_fix_config_ux_and_prefill_bug.py::TestConfigUXPrefillFix::test_guided_setup_for_relay_server FAILED [ 68%]
tests/tool_delete_server_config/test_fix_config_ux_and_prefill_bug.py::TestConfigUXPrefillFix::test_update_relay_server_with_prefill_issues FAILED [ 68%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_applescript_syntax_validation PASSED [ 69%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_cleanup_configuration PASSED [ 69%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_cleanup_disabled_behavior PASSED [ 70%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_cleanup_script_no_pwd_command PASSED [ 70%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_cleanup_terminals_method PASSED [ 71%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_force_cleanup_script_generation PASSED [ 71%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_force_cleanup_terminals_method PASSED [ 72%]
tests/tool_disconnect_server/test_fix_terminal_cleanup_bug_20241222.py::TestTerminalCleanupBugFix::test_project_path_detection PASSED [ 72%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_reproduce_original_issue FAILED [ 73%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_verify_fix PASSED [ 73%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_boundary_conditions PASSED [ 74%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_integration_with_other_components FAILED [ 74%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_mcp_tool_error_handling PASSED [ 75%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_mcp_tool_command_validation PASSED [ 75%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_mcp_testing_utils_import PASSED [ 75%]
tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_environment_isolation PASSED [ 76%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_code_change_detection PASSED [ 76%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_index_js_startup_with_python_backend PASSED [ 77%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_mcp_server_import_validation PASSED [ 77%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_mcp_server_restart_simulation PASSED [ 78%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_mcp_server_startup_without_errors PASSED [ 78%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_mcp_server_syntax_validation PASSED [ 79%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_new_update_server_config_logic_loading FAILED [ 79%]
tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_tools_list_generation PASSED [ 80%]
tests/tool_get_server_info/test_server_info.py::TestServerInfoCollector::test_get_user_host_with_mock PASSED [ 80%]
tests/tool_get_server_info/test_server_info.py::TestServerInfoCollector::test_parse_user_host PASSED [ 81%]
tests/tool_get_server_info/test_server_info.py::TestServerInfoCollector::test_validate_port PASSED [ 81%]
tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_cursorrules_quality_gates PASSED [ 82%]
tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_quality_assurance_workflow_compliance PASSED [ 82%]
tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_regression_directory_structure FAILED [ 83%]
tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_regression_test_content_quality PASSED [ 83%]
tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_regression_test_naming_convention FAILED [ 84%]
tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_regression_test_script_exists PASSED [ 84%]
tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPSilentConfigRegression::test_constructor_without_force_interactive FAILED [ 85%]
tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPSilentConfigRegression::test_mcp_silent_setup_auto_defaults PASSED [ 85%]
tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPSilentConfigRegression::test_mcp_silent_setup_basic PASSED [ 86%]
tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPSilentConfigRegression::test_mcp_silent_setup_validation PASSED [ 86%]
tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPSilentConfigRegression::test_smart_input_detailed_error_messages FAILED [ 87%]
tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPServerSilentIntegration::test_create_server_config_tool_error_handling SKIPPED [ 87%]
tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPServerSilentIntegration::test_create_server_config_tool_silent_mode SKIPPED [ 87%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_auto_sync_manager_creation PASSED [ 88%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_auto_sync_manager_import PASSED [ 88%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_docker_environment_integration PASSED [ 89%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_error_handling_and_fallback PASSED [ 89%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_mcp_tools_sync_parameters PASSED [ 90%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_proftpd_file_validation PASSED [ 90%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_server_config_auto_sync_fields PASSED [ 91%]
tests/tool_sync_config/test_auto_sync_manager_implementation.py::TestAutoSyncManagerImplementation::test_sync_config_creation PASSED [ 91%]
tests/tool_sync_config/test_sync_config.py::TestSyncConfigCollector::test_configure_sync_skip PASSED [ 92%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_collect_sync_patterns_add_new FAILED [ 92%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_collect_sync_patterns_method_exists FAILED [ 93%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_collect_sync_patterns_with_defaults FAILED [ 93%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_configure_sync_disabled FAILED [ 94%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_configure_sync_enabled_full_config FAILED [ 94%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_configure_sync_method_exists PASSED [ 95%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_configure_sync_with_defaults FAILED [ 95%]
tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_guided_setup_integration FAILED [ 96%]
tests/tool_update_server_config/test_fix_update_server_interactive_behavior_20241222.py::TestUpdateServerInteractiveBehavior::test_update_behavior_consistency_with_create PASSED [ 96%]
tests/tool_update_server_config/test_fix_update_server_interactive_behavior_20241222.py::TestUpdateServerInteractiveBehavior::test_update_server_docker_config_handling PASSED [ 97%]
tests/tool_update_server_config/test_fix_update_server_interactive_behavior_20241222.py::TestUpdateServerInteractiveBehavior::test_update_server_error_handling PASSED [ 97%]
tests/tool_update_server_config/test_fix_update_server_interactive_behavior_20241222.py::TestUpdateServerInteractiveBehavior::test_update_server_launches_interactive_interface PASSED [ 98%]
tests/tool_update_server_config/test_fix_update_server_interactive_behavior_20241222.py::TestUpdateServerInteractiveBehavior::test_update_server_preserves_existing_config PASSED [ 98%]
tests/tool_update_server_config/test_fix_update_server_interactive_behavior_20241222.py::TestUpdateServerInteractiveBehavior::test_update_server_relay_config_handling PASSED [ 99%]
tests/tool_update_server_config/test_interactive_update_server_config.py::test_interactive_update_server_config FAILED [ 99%]
tests/tool_update_server_config/test_interactive_update_server_config_prefill.py::test_interactive_update_server_config_prefill FAILED [100%]

=================================== FAILURES ===================================
_ TestInteractiveStartupRequirement.test_create_server_config_must_start_interactive_interface _

self = <python.tests.tool_connect_server.test_fix_interactive_startup_requirement_20241222.TestInteractiveStartupRequirement testMethod=test_create_server_config_must_start_interactive_interface>

    def test_create_server_config_must_start_interactive_interface(self):
        """
        Ê†∏ÂøÉÊµãËØïÔºöcreate_server_configÂ∑•ÂÖ∑ÂøÖÈ°ªÂêØÂä®‰∫§‰∫íÈÖçÁΩÆÁïåÈù¢
    
        ÊµãËØïÊ≠•È™§Ôºö
        1. ÂáÜÂ§áÊµãËØïÂèÇÊï∞
        2. Ë∞ÉÁî®launch_cursor_terminal_configÊñπÊ≥ï
        3. È™åËØÅËøîÂõûÁªìÊûúË°®ÊòéÊàêÂäüÂêØÂä®ÔºàËÄå‰∏çÊòØÊèê‰æõÊâãÂä®ÂëΩ‰ª§Ôºâ
        4. È™åËØÅËøõÁ®ãÁ°ÆÂÆûÂú®ËøêË°å
        5. È™åËØÅÈ¢ÑÂ°´ÂÖÖÊñá‰ª∂Â≠òÂú®‰∏îÂÜÖÂÆπÊ≠£Á°Æ
        """
        print("\nüéØ ÂºÄÂßãÊµãËØïÔºöcreate_server_configÂøÖÈ°ªÂêØÂä®‰∫§‰∫íÈÖçÁΩÆÁïåÈù¢")
    
        # Á¨¨1Ê≠•ÔºöÂáÜÂ§áÊµãËØïÂèÇÊï∞
        test_params = {
            'name': 'test_interactive_startup',
            'host': 'test.example.com',
            'username': 'testuser',
            'port': 22,
            'connection_type': 'relay',
            'description': 'ÊµãËØï‰∫§‰∫íÂêØÂä®ÂäüËÉΩ',
            'docker_enabled': True,
            'docker_image': 'ubuntu:20.04',
            'docker_container': 'test_container'
        }
    
        print(f"üìã ÊµãËØïÂèÇÊï∞: {json.dumps(test_params, ensure_ascii=False, indent=2)}")
    
        # Á¨¨2Ê≠•ÔºöË∞ÉÁî®ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÁöÑÂêØÂä®ÊñπÊ≥ï
        print("üöÄ Ë∞ÉÁî®launch_cursor_terminal_configÊñπÊ≥ï...")
        try:
            result = self.config_manager.launch_cursor_terminal_config(prefill_params=test_params)
            print(f"üìÑ ËøîÂõûÁªìÊûú: {json.dumps(result, ensure_ascii=False, indent=2)}")
        except Exception as e:
            self.fail(f"‚ùå Ë∞ÉÁî®launch_cursor_terminal_configÂ§±Ë¥•: {e}")
    
        # Á¨¨3Ê≠•ÔºöÈ™åËØÅËøîÂõûÁªìÊûúË°®ÊòéÊàêÂäüÂêØÂä®
        print("üîç È™åËØÅËøîÂõûÁªìÊûú...")
    
        # ÂøÖÈ°ªËøîÂõûÊàêÂäüÁä∂ÊÄÅ
>       self.assertTrue(result.get('success'),
                       f"‚ùå ÊúüÊúõËøîÂõûsuccess=TrueÔºåÂÆûÈôÖÂæóÂà∞: {result.get('success')}")
E       AttributeError: 'NoneType' object has no attribute 'get'

python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py:112: AttributeError
----------------------------- Captured stdout call -----------------------------

üéØ ÂºÄÂßãÊµãËØïÔºöcreate_server_configÂøÖÈ°ªÂêØÂä®‰∫§‰∫íÈÖçÁΩÆÁïåÈù¢
üìã ÊµãËØïÂèÇÊï∞: {
  "name": "test_interactive_startup",
  "host": "test.example.com",
  "username": "testuser",
  "port": 22,
  "connection_type": "relay",
  "description": "ÊµãËØï‰∫§‰∫íÂêØÂä®ÂäüËÉΩ",
  "docker_enabled": true,
  "docker_image": "ubuntu:20.04",
  "docker_container": "test_container"
}
üöÄ Ë∞ÉÁî®launch_cursor_terminal_configÊñπÊ≥ï...
üìÑ ËøîÂõûÁªìÊûú: null
üîç È™åËØÅËøîÂõûÁªìÊûú...
_ TestInteractiveStartupRequirement.test_interactive_startup_failure_diagnosis _

self = <python.tests.tool_connect_server.test_fix_interactive_startup_requirement_20241222.TestInteractiveStartupRequirement testMethod=test_interactive_startup_failure_diagnosis>

    def test_interactive_startup_failure_diagnosis(self):
        """ÊµãËØïÂêØÂä®Â§±Ë¥•Êó∂ÁöÑËØäÊñ≠‰ø°ÊÅØ"""
        print("\nüéØ ÂºÄÂßãÊµãËØïÔºöÂêØÂä®Â§±Ë¥•ËØäÊñ≠")
    
        # Â∞ùËØï‰ΩøÁî®Êó†ÊïàÂèÇÊï∞ÔºàËøôÂèØËÉΩ‰∏ç‰ºöÂØºËá¥Â§±Ë¥•Ôºå‰ΩÜÊàë‰ª¨ÊµãËØïÈîôËØØÂ§ÑÁêÜÔºâ
        invalid_params = {
            'name': '',  # Á©∫ÂêçÁß∞
            'host': '',  # Á©∫‰∏ªÊú∫
            'username': ''  # Á©∫Áî®Êà∑Âêç
        }
    
        result = self.config_manager.launch_cursor_terminal_config(prefill_params=invalid_params)
    
        # Âç≥‰ΩøÂèÇÊï∞Êó†ÊïàÔºåÂêØÂä®Êú∫Âà∂Êú¨Ë∫´Â∫îËØ•Â∑•‰Ωú
        # Â¶ÇÊûúÂ§±Ë¥•ÔºåÂ∫îËØ•ÊúâËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ
>       if not result.get('success'):
E       AttributeError: 'NoneType' object has no attribute 'get'

python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py:237: AttributeError
----------------------------- Captured stdout call -----------------------------

üéØ ÂºÄÂßãÊµãËØïÔºöÂêØÂä®Â§±Ë¥•ËØäÊñ≠
_ TestInteractiveStartupRequirement.test_interactive_startup_with_minimal_params _

self = <python.tests.tool_connect_server.test_fix_interactive_startup_requirement_20241222.TestInteractiveStartupRequirement testMethod=test_interactive_startup_with_minimal_params>

    def test_interactive_startup_with_minimal_params(self):
        """ÊµãËØïÊúÄÂ∞èÂèÇÊï∞‰∏ãÁöÑ‰∫§‰∫íÂêØÂä®"""
        print("\nüéØ ÂºÄÂßãÊµãËØïÔºöÊúÄÂ∞èÂèÇÊï∞‰∏ãÁöÑ‰∫§‰∫íÂêØÂä®")
    
        minimal_params = {
            'name': 'test_minimal',
            'host': 'minimal.test.com',
            'username': 'minimal_user'
        }
    
        result = self.config_manager.launch_cursor_terminal_config(prefill_params=minimal_params)
    
        # È™åËØÅÂü∫Êú¨ÊàêÂäüÊù°‰ª∂
>       self.assertTrue(result.get('success'), "ÊúÄÂ∞èÂèÇÊï∞ÊµãËØïÂ§±Ë¥•")
E       AttributeError: 'NoneType' object has no attribute 'get'

python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py:210: AttributeError
----------------------------- Captured stdout call -----------------------------

üéØ ÂºÄÂßãÊµãËØïÔºöÊúÄÂ∞èÂèÇÊï∞‰∏ãÁöÑ‰∫§‰∫íÂêØÂä®
_____ TestUserVisibleInteraction.test_interactive_interface_accessibility ______

self = <python.tests.tool_connect_server.test_fix_user_visible_interaction_20241222.TestUserVisibleInteraction testMethod=test_interactive_interface_accessibility>

    def test_interactive_interface_accessibility(self):
        """
        ÊµãËØï‰∫§‰∫íÁïåÈù¢ÊòØÂê¶ÂèØËÆøÈóÆÔºàÁî®Êà∑ËÉΩÂê¶‰∏é‰πã‰∫§‰∫íÔºâ
        """
        print("\nüéØ ÊµãËØï‰∫§‰∫íÁïåÈù¢ÂèØËÆøÈóÆÊÄß")
    
        # Ëøô‰∏™ÊµãËØïÊ£ÄÊü•ÁöÑÊòØÔºöÂêØÂä®ÁöÑËøõÁ®ãÊòØÂê¶ËÉΩÊé•ÂèóÁî®Êà∑ËæìÂÖ•
        test_params = {
            'name': 'test_accessibility',
            'host': 'access.test.com',
            'username': 'access_user'
        }
    
        result = self.config_manager.launch_cursor_terminal_config(prefill_params=test_params)
    
        # ËÆ∞ÂΩïÊñá‰ª∂Áî®‰∫éÊ∏ÖÁêÜ
>       if result.get('prefill_file'):
E       AttributeError: 'NoneType' object has no attribute 'get'

python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py:204: AttributeError
----------------------------- Captured stdout call -----------------------------

üéØ ÊµãËØï‰∫§‰∫íÁïåÈù¢ÂèØËÆøÈóÆÊÄß
______ TestUserVisibleInteraction.test_terminal_window_creation_on_macos _______

self = <python.tests.tool_connect_server.test_fix_user_visible_interaction_20241222.TestUserVisibleInteraction testMethod=test_terminal_window_creation_on_macos>

    def test_terminal_window_creation_on_macos(self):
        """
        ÊµãËØïÂú®macOS‰∏äÊòØÂê¶ÁúüÁöÑÂàõÂª∫‰∫ÜÊñ∞ÁöÑTerminalÁ™óÂè£
        """
        print("\nüéØ ÊµãËØïTerminalÁ™óÂè£ÂàõÂª∫ÔºàmacOSÔºâ")
    
        # Âè™Âú®macOS‰∏äËøêË°åËøô‰∏™ÊµãËØï
        import platform
        if platform.system() != "Darwin":
            self.skipTest("Ê≠§ÊµãËØï‰ªÖÈÄÇÁî®‰∫émacOS")
    
        # ËÆ∞ÂΩïÂêØÂä®ÂâçÁöÑTerminalÁ™óÂè£Êï∞Èáè
        try:
            result = subprocess.run([
                "osascript", "-e",
                'tell application "Terminal" to count windows'
            ], capture_output=True, text=True, timeout=5)
    
            if result.returncode == 0:
                windows_before = int(result.stdout.strip())
                print(f"üìä ÂêØÂä®ÂâçTerminalÁ™óÂè£Êï∞: {windows_before}")
            else:
                windows_before = 0
                print("‚ö†Ô∏è Êó†Ê≥ïËé∑ÂèñTerminalÁ™óÂè£Êï∞ÔºåÂÅáËÆæ‰∏∫0")
    
        except Exception as e:
            windows_before = 0
            print(f"‚ö†Ô∏è Ê£ÄÊü•TerminalÁ™óÂè£Â§±Ë¥•: {e}")
    
        # ÂêØÂä®ÈÖçÁΩÆÁïåÈù¢
        test_params = {
            'name': 'test_terminal_window',
            'host': 'terminal.test.com',
            'username': 'terminal_user'
        }
    
        result = self.config_manager.launch_cursor_terminal_config(prefill_params=test_params)
    
        # ËÆ∞ÂΩïÊñá‰ª∂Áî®‰∫éÊ∏ÖÁêÜ
>       if result.get('prefill_file'):
E       AttributeError: 'NoneType' object has no attribute 'get'

python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py:109: AttributeError
----------------------------- Captured stdout call -----------------------------

üéØ ÊµãËØïTerminalÁ™óÂè£ÂàõÂª∫ÔºàmacOSÔºâ
üìä ÂêØÂä®ÂâçTerminalÁ™óÂè£Êï∞: 1
_ TestFullyAutomatedInteractive.test_guided_setup_docker_server_full_automation _

self = <python.tests.tool_connect_server.test_fully_automated_interactive.TestFullyAutomatedInteractive testMethod=test_guided_setup_docker_server_full_automation>

    def test_guided_setup_docker_server_full_automation(self):
        """ÊµãËØïÂÆåÂÖ®Ëá™Âä®ÂåñÁöÑDockerÊúçÂä°Âô®ÈÖçÁΩÆ"""
        # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Â∫èÂàóÔºàÂåÖÂê´DockerÈÖçÁΩÆÔºâ
        user_inputs = [
            '1',                    # ÈÄâÊã©ÂºïÂØºÈÖçÁΩÆ
            'test-docker-server',   # ÊúçÂä°Âô®ÂêçÁß∞
            '192.168.1.101',        # ÊúçÂä°Âô®Âú∞ÂùÄ
            'dockeruser',           # Áî®Êà∑Âêç
            '2222',                 # SSHÁ´ØÂè£
            '1',                    # ÈÄâÊã©SSHËøûÊé•Á±ªÂûã
            'Test Docker Server',   # ÊúçÂä°Âô®ÊèèËø∞
            'y',                    # ÂêØÁî®Docker
            'ubuntu:22.04',         # DockerÈïúÂÉè
            'test-container',       # ÂÆπÂô®ÂêçÁß∞
            'y',                    # Ëá™Âä®ÂàõÂª∫ÂÆπÂô®
            'y'                     # Á°ÆËÆ§‰øùÂ≠òÈÖçÁΩÆ
        ]
        all_inputs = itertools.chain(user_inputs, itertools.repeat('22'))
        def input_side_effect(prompt):
            if "Á´ØÂè£" in str(prompt) or "port" in str(prompt):
                return "22"
            try:
                return next(all_inputs)
            except StopIteration:
                return ""
        with patch('builtins.input', side_effect=input_side_effect):
            with patch('sys.stdout', new_callable=StringIO) as mock_stdout:
                result = self.config_manager.guided_setup()
    
        # È™åËØÅÈÖçÁΩÆÊàêÂäü
        self.assertTrue(result, "DockerÂºïÂØºÈÖçÁΩÆÂ∫îËØ•ÊàêÂäü")
    
        # È™åËØÅÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ
        with open(self.config_file, 'r', encoding='utf-8') as f:
            config = yaml.safe_load(f)
    
>       server_config = config['servers']['test-docker-server']
E       KeyError: 'test-docker-server'

python/tests/tool_connect_server/test_fully_automated_interactive.py:123: KeyError
_ TestFullyAutomatedInteractive.test_guided_setup_relay_server_full_automation _

self = <python.tests.tool_connect_server.test_fully_automated_interactive.TestFullyAutomatedInteractive testMethod=test_guided_setup_relay_server_full_automation>

    def test_guided_setup_relay_server_full_automation(self):
        """ÊµãËØïÂÆåÂÖ®Ëá™Âä®ÂåñÁöÑRelayÊúçÂä°Âô®ÈÖçÁΩÆ"""
        # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Â∫èÂàóÔºàRelayËøûÊé•Ôºâ
        user_inputs = [
            '1',                        # ÈÄâÊã©ÂºïÂØºÈÖçÁΩÆ
            'test-relay-server',        # ÊúçÂä°Âô®ÂêçÁß∞
            'internal.server.com',      # ÊúçÂä°Âô®Âú∞ÂùÄ
            'relayuser',                # Áî®Êà∑Âêç
            '22',                       # SSHÁ´ØÂè£
            '2',                        # ÈÄâÊã©RelayËøûÊé•Á±ªÂûã
            'internal.server.com',      # RelayÁõÆÊ†á‰∏ªÊú∫
            'Test Relay Server',        # ÊúçÂä°Âô®ÊèèËø∞
            'n',                        # ‰∏çÂêØÁî®Docker
            'y'                         # Á°ÆËÆ§‰øùÂ≠òÈÖçÁΩÆ
        ]
        all_inputs = itertools.chain(user_inputs, itertools.repeat('22'))
        def input_side_effect(prompt):
            if "Á´ØÂè£" in str(prompt) or "port" in str(prompt):
                return "22"
            try:
                return next(all_inputs)
            except StopIteration:
                return ""
        with patch('builtins.input', side_effect=input_side_effect):
            with patch('sys.stdout', new_callable=StringIO) as mock_stdout:
                result = self.config_manager.guided_setup()
    
        # È™åËØÅÈÖçÁΩÆÊàêÂäü
        self.assertTrue(result, "RelayÂºïÂØºÈÖçÁΩÆÂ∫îËØ•ÊàêÂäü")
    
        # È™åËØÅÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ
        with open(self.config_file, 'r', encoding='utf-8') as f:
            config = yaml.safe_load(f)
    
>       server_config = config['servers']['test-relay-server']
E       KeyError: 'test-relay-server'

python/tests/tool_connect_server/test_fully_automated_interactive.py:171: KeyError
__ TestFullyAutomatedInteractive.test_guided_setup_ssh_server_full_automation __

self = <python.tests.tool_connect_server.test_fully_automated_interactive.TestFullyAutomatedInteractive testMethod=test_guided_setup_ssh_server_full_automation>

    def test_guided_setup_ssh_server_full_automation(self):
        """ÊµãËØïÂÆåÂÖ®Ëá™Âä®ÂåñÁöÑSSHÊúçÂä°Âô®ÈÖçÁΩÆ"""
        # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Â∫èÂàó
        user_inputs = [
            '1',                    # ÈÄâÊã©ÂºïÂØºÈÖçÁΩÆ
            'test-ssh-server',      # ÊúçÂä°Âô®ÂêçÁß∞
            '192.168.1.100',        # ÊúçÂä°Âô®Âú∞ÂùÄ
            'testuser',             # Áî®Êà∑Âêç
            '22',                   # SSHÁ´ØÂè£
            '1',                    # ÈÄâÊã©SSHËøûÊé•Á±ªÂûã
            'Test SSH Server',      # ÊúçÂä°Âô®ÊèèËø∞
            'n',                    # ‰∏çÂêØÁî®Docker
            'y'                     # Á°ÆËÆ§‰øùÂ≠òÈÖçÁΩÆ
        ]
        all_inputs = itertools.chain(user_inputs, itertools.repeat('22'))
        def input_side_effect(prompt):
            if "Á´ØÂè£" in str(prompt) or "port" in str(prompt):
                return "22"
            try:
                return next(all_inputs)
            except StopIteration:
                return ""
        with patch('builtins.input', side_effect=input_side_effect):
            with patch('sys.stdout', new_callable=StringIO) as mock_stdout:
                result = self.config_manager.guided_setup()
    
        # È™åËØÅÈÖçÁΩÆÊàêÂäü
        self.assertTrue(result, "ÂºïÂØºÈÖçÁΩÆÂ∫îËØ•ÊàêÂäü")
    
        # È™åËØÅÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ
        self.assertTrue(self.config_file.exists(), "ÈÖçÁΩÆÊñá‰ª∂Â∫îËØ•Ë¢´ÂàõÂª∫")
    
        with open(self.config_file, 'r', encoding='utf-8') as f:
            config = yaml.safe_load(f)
    
        self.assertIn('servers', config)
>       self.assertIn('test-ssh-server', config['servers'])
E       AssertionError: 'test-ssh-server' not found in {'test_server': {}}

python/tests/tool_connect_server/test_fully_automated_interactive.py:78: AssertionError
___ TestFullyAutomatedInteractive.test_smart_input_error_recovery_automation ___

self = <python.tests.tool_connect_server.test_fully_automated_interactive.TestFullyAutomatedInteractive testMethod=test_smart_input_error_recovery_automation>

    def test_smart_input_error_recovery_automation(self):
        """ÊµãËØïÊô∫ËÉΩËæìÂÖ•ÁöÑÈîôËØØÊÅ¢Â§çËá™Âä®Âåñ"""
        # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•ÈîôËØØÁÑ∂ÂêéÁ∫†Ê≠£ÁöÑÂú∫ÊôØ
        user_inputs = [
            '1',                        # ÈÄâÊã©ÂºïÂØºÈÖçÁΩÆ
            'test-error-recovery',      # ÊúçÂä°Âô®ÂêçÁß∞
            'invalid host with spaces', # Êó†ÊïàÁöÑÊúçÂä°Âô®Âú∞ÂùÄÔºàÁ¨¨‰∏ÄÊ¨°Ôºâ
            '192.168.1.102',            # Ê≠£Á°ÆÁöÑÊúçÂä°Âô®Âú∞ÂùÄÔºàÁ¨¨‰∫åÊ¨°Ôºâ
            'a',                        # Êó†ÊïàÁöÑÁî®Êà∑ÂêçÔºàÂ§™Áü≠Ôºâ
            'validuser',                # Ê≠£Á°ÆÁöÑÁî®Êà∑Âêç
            '99999',                    # Êó†ÊïàÁöÑÁ´ØÂè£Âè∑
            '22',                       # Ê≠£Á°ÆÁöÑÁ´ØÂè£Âè∑
            '1',                        # ÈÄâÊã©SSHËøûÊé•Á±ªÂûã
            'Error Recovery Test',      # ÊúçÂä°Âô®ÊèèËø∞
            'n',                        # ‰∏çÂêØÁî®Docker
            'y'                         # Á°ÆËÆ§‰øùÂ≠òÈÖçÁΩÆ
        ]
        all_inputs = itertools.chain(user_inputs, itertools.repeat('22'))
        def input_side_effect(prompt):
            if "Á´ØÂè£" in str(prompt) or "port" in str(prompt):
                return "22"
            try:
                return next(all_inputs)
            except StopIteration:
                return ""
        with patch('builtins.input', side_effect=input_side_effect):
            with patch('sys.stdout', new_callable=StringIO) as mock_stdout:
                result = self.config_manager.guided_setup()
                output = mock_stdout.getvalue()
    
        # È™åËØÅÈÖçÁΩÆÊúÄÁªàÊàêÂäü
        self.assertTrue(result, "ÈîôËØØÊÅ¢Â§çÂêéÁöÑÈÖçÁΩÆÂ∫îËØ•ÊàêÂäü")
    
        # È™åËØÅÈîôËØØÊèêÁ§∫Âá∫Áé∞Âú®ËæìÂá∫‰∏≠
>       self.assertIn('ËæìÂÖ•È™åËØÅÂ§±Ë¥•', output)
E       AssertionError: 'ËæìÂÖ•È™åËØÅÂ§±Ë¥•' not found in ''

python/tests/tool_connect_server/test_fully_automated_interactive.py:217: AssertionError
______ TestInputValidationAutomation.test_hostname_validation_automation _______

self = <python.tests.tool_connect_server.test_fully_automated_interactive.TestInputValidationAutomation testMethod=test_hostname_validation_automation>

    def test_hostname_validation_automation(self):
        """ÊµãËØï‰∏ªÊú∫ÂêçÈ™åËØÅÁöÑËá™Âä®Âåñ"""
        # ÊµãËØïÂêÑÁßçÊó†ÊïàËæìÂÖ•ÁÑ∂ÂêéÊèê‰æõÊúâÊïàËæìÂÖ•
        invalid_then_valid_inputs = [
            'invalid host',         # ÂåÖÂê´Á©∫Ê†º
            '192.168.1.999',        # Êó†ÊïàIP
            'host..invalid',        # ÂèåÁÇπ
            'valid-host.com'        # ÊúâÊïà‰∏ªÊú∫Âêç
        ]
    
        def input_side_effect(prompt):
            if "Á´ØÂè£" in str(prompt) or "port" in str(prompt):
                return "22"
            try:
                return next(iter(invalid_then_valid_inputs))
            except StopIteration:
                return ""
        inputs_iter = iter(invalid_then_valid_inputs)
        with patch('builtins.input', side_effect=input_side_effect), \
             patch.object(UserInteraction, 'smart_input', side_effect=input_side_effect):
            result = self.config_manager.smart_input(
                "üåê ÊúçÂä°Âô®Âú∞ÂùÄ",
                validator=self.config_manager.validate_hostname
            )
>           output = mock_stdout.getvalue()
E           NameError: name 'mock_stdout' is not defined

python/tests/tool_connect_server/test_fully_automated_interactive.py:275: NameError
----------------------------- Captured stdout call -----------------------------
ËæìÂÖ•È™åËØÅÂ§±Ë¥•ÔºöÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º„ÄÇÊ≠£Á°ÆÊ†ºÂºèÁ§∫‰æãÔºö192.168.1.100
________ TestInputValidationAutomation.test_port_validation_automation _________

self = <python.tests.tool_connect_server.test_fully_automated_interactive.TestInputValidationAutomation testMethod=test_port_validation_automation>

    def test_port_validation_automation(self):
        """ÊµãËØïÁ´ØÂè£È™åËØÅÁöÑËá™Âä®Âåñ"""
        invalid_then_valid_inputs = [
            '0',            # Á´ØÂè£Âè∑Â§™Â∞è
            '99999',        # Á´ØÂè£Âè∑Â§™Â§ß
            'abc',          # ÈùûÊï∞Â≠ó
            '22'            # ÊúâÊïàÁ´ØÂè£
        ]
    
        def input_side_effect(prompt):
            if "Á´ØÂè£" in str(prompt) or "port" in str(prompt):
                return "22"
            try:
                return next(iter(invalid_then_valid_inputs))
            except StopIteration:
                return ""
        inputs_iter = iter(invalid_then_valid_inputs)
        with patch('builtins.input', side_effect=input_side_effect), \
             patch.object(UserInteraction, 'smart_input', side_effect=input_side_effect):
            result = self.config_manager.smart_input(
                "üîå SSHÁ´ØÂè£",
                validator=self.config_manager.validate_port
            )
>           output = mock_stdout.getvalue()
E           NameError: name 'mock_stdout' is not defined

python/tests/tool_connect_server/test_fully_automated_interactive.py:304: NameError
----------------------------- Captured stdout call -----------------------------
ËæìÂÖ•È™åËØÅÂ§±Ë¥•ÔºöÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º„ÄÇÊ≠£Á°ÆÊ†ºÂºèÁ§∫‰æãÔºö192.168.1.100
________ TestConfigurationConsistency.test_config_directory_consistency ________

self = <python.tests.tool_connect_server.test_mcp_tools.TestConfigurationConsistency testMethod=test_config_directory_consistency>

    def test_config_directory_consistency(self):
        """ÊµãËØïÈÖçÁΩÆÁõÆÂΩï‰∏ÄËá¥ÊÄß"""
        from config_manager.main import EnhancedConfigManager
        from docker_config_manager import DockerConfigManager
    
>       enhanced_manager = config_manager.main.EnhancedConfigManager()
E       NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_mcp_tools.py:145: NameError
_________________ TestNPMPackageIntegrity.test_main_entry_file _________________

self = <python.tests.tool_connect_server.test_package_integrity.TestNPMPackageIntegrity testMethod=test_main_entry_file>

    def test_main_entry_file(self):
        """ÊµãËØï‰∏ªÂÖ•Âè£Êñá‰ª∂"""
        with open(self.package_json_path) as f:
            package_data = json.load(f)
    
        main_file = self.project_root / package_data['main']
>       self.assertTrue(main_file.exists(),
                       f"‰∏ªÂÖ•Âè£Êñá‰ª∂{package_data['main']}ÂøÖÈ°ªÂ≠òÂú®")
E       AssertionError: False is not true : ‰∏ªÂÖ•Âè£Êñá‰ª∂index.jsÂøÖÈ°ªÂ≠òÂú®

python/tests/tool_connect_server/test_package_integrity.py:55: AssertionError
______________ TestNPMPackageIntegrity.test_required_python_files ______________

self = <python.tests.tool_connect_server.test_package_integrity.TestNPMPackageIntegrity testMethod=test_required_python_files>

    def test_required_python_files(self):
        """ÊµãËØïÂøÖË¶ÅÁöÑPythonÊñá‰ª∂"""
        required_files = [
            'enhanced_config_manager.py',
            'docker_config_manager.py',
            'python/mcp_server.py'
        ]
    
        for file_path in required_files:
            full_path = self.project_root / file_path
>           self.assertTrue(full_path.exists(),
                           f"ÂøÖË¶ÅÊñá‰ª∂{file_path}ÂøÖÈ°ªÂ≠òÂú®")
E           AssertionError: False is not true : ÂøÖË¶ÅÊñá‰ª∂enhanced_config_manager.pyÂøÖÈ°ªÂ≠òÂú®

python/tests/tool_connect_server/test_package_integrity.py:74: AssertionError
_______________ TestNPMPackageInstallation.test_npm_pack_success _______________

self = <python.tests.tool_connect_server.test_package_integrity.TestNPMPackageInstallation testMethod=test_npm_pack_success>

    def test_npm_pack_success(self):
        """ÊµãËØïnpm packÊàêÂäü"""
        try:
            result = run_command(['npm', 'pack'],
                                cwd=self.project_root, timeout=60)
    
>           self.assertEqual(result.returncode, 0,
                           f"npm packÂ§±Ë¥•: {result.stderr}")
E                          AssertionError: 1 != 0 : npm packÂ§±Ë¥•: npm error no files or directories specified
E                          npm error A complete log of this run can be found in: /Users/xuyehua/.npm/_logs/2025-07-16T16_16_39_142Z-debug-0.log

python/tests/tool_connect_server/test_package_integrity.py:117: AssertionError

During handling of the above exception, another exception occurred:

self = <python.tests.tool_connect_server.test_package_integrity.TestNPMPackageInstallation testMethod=test_npm_pack_success>

    def test_npm_pack_success(self):
        """ÊµãËØïnpm packÊàêÂäü"""
        try:
            result = run_command(['npm', 'pack'],
                                cwd=self.project_root, timeout=60)
    
            self.assertEqual(result.returncode, 0,
                           f"npm packÂ§±Ë¥•: {result.stderr}")
    
            # npm pack‰ºöÁîüÊàê.tgzÊñá‰ª∂ÔºåÊ£ÄÊü•Êñá‰ª∂ÊòØÂê¶ÁîüÊàê
            output = result.stdout.strip()
            self.assertTrue(output.endswith('.tgz'),
                          f"npm packÂ∫îËØ•ÁîüÊàê.tgzÊñá‰ª∂ÔºåÂÆûÈôÖËæìÂá∫: {output}")
    
            # Ê£ÄÊü•ÁîüÊàêÁöÑÊñá‰ª∂ÊòØÂê¶Â≠òÂú®
            tgz_file = self.project_root / output
            self.assertTrue(tgz_file.exists(),
                          f"ÁîüÊàêÁöÑÂåÖÊñá‰ª∂{output}Â∫îËØ•Â≠òÂú®")
    
            # Ê∏ÖÁêÜÁîüÊàêÁöÑÊñá‰ª∂
            if tgz_file.exists():
                tgz_file.unlink()
    
        except subprocess.TimeoutExpired:
            self.fail("npm packÂëΩ‰ª§Ë∂ÖÊó∂")
        except Exception as e:
>           self.fail(f"npm packÊµãËØïÂ§±Ë¥•: {e}")
E           AssertionError: npm packÊµãËØïÂ§±Ë¥•: 1 != 0 : npm packÂ§±Ë¥•: npm error no files or directories specified
E           npm error A complete log of this run can be found in: /Users/xuyehua/.npm/_logs/2025-07-16T16_16_39_142Z-debug-0.log

python/tests/tool_connect_server/test_package_integrity.py:137: AssertionError
_ TestConfigurationPersistenceRegression.test_ensure_config_exists_preserves_user_config _

self = <python.tests.tool_connect_server.test_regression_prevention.TestConfigurationPersistenceRegression testMethod=test_ensure_config_exists_preserves_user_config>

        def test_ensure_config_exists_preserves_user_config(self):
            """ÊµãËØïensure_config_exists‰∏ç‰ºöË¶ÜÁõñÁî®Êà∑ÈÖçÁΩÆ"""
            # ËÆæÁΩÆÊµãËØïÁéØÂ¢É
            os.environ['HOME'] = str(self.test_dir)
            self.config_dir.mkdir(parents=True, exist_ok=True)
    
            # ÂàõÂª∫Áî®Êà∑ÈÖçÁΩÆ
            user_config = """# User Configuration
    global_settings:
      auto_recovery: true
      default_shell: zsh
      default_timeout: 90
      log_level: DEBUG
      default_server: "production"
    
    servers:
      example-server:
        description: "ÊàëÁöÑÂºÄÂèëÊúçÂä°Âô®"
        host: dev.mycompany.com
        port: 2222
        username: developer
        type: script_based
    
      production:
        description: "Áîü‰∫ßÊúçÂä°Âô®"
        host: prod.mycompany.com
        port: 22
        username: admin
        type: script_based
    """
    
            with open(self.config_file, "w") as f:
                f.write(user_config)
    
            # ËÆ∞ÂΩïÂéüÂßãÁä∂ÊÄÅ
            original_mtime = self.config_file.stat().st_mtime
            original_content = self.config_file.read_text()
    
            # Â§öÊ¨°Ë∞ÉÁî®ensure_config_exists
            from config_manager.main import EnhancedConfigManager
>           manager = config_manager.main.EnhancedConfigManager()
E           NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_regression_prevention.py:227: NameError
_ TestConfigurationPersistenceRegression.test_get_existing_servers_preserves_user_modifications _

self = <python.tests.tool_connect_server.test_regression_prevention.TestConfigurationPersistenceRegression testMethod=test_get_existing_servers_preserves_user_modifications>

        def test_get_existing_servers_preserves_user_modifications(self):
            """ÊµãËØïget_existing_servers‰øùÁïôÁî®Êà∑‰øÆÊîπ"""
            # ËÆæÁΩÆÊµãËØïÁéØÂ¢É
            os.environ['HOME'] = str(self.test_dir)
            self.config_dir.mkdir(parents=True, exist_ok=True)
    
            # ÂàõÂª∫ÂåÖÂê´Áî®Êà∑‰øÆÊîπÁöÑÈÖçÁΩÆ
            user_config = """servers:
      example-server:
        description: "ÊàëÁöÑÊµãËØïÊúçÂä°Âô®"
        host: test.example.com
        port: 2222
        username: testuser
        type: script_based
      custom-server:
        description: "Ëá™ÂÆö‰πâÊúçÂä°Âô®"
        host: custom.example.com
        port: 22
        username: admin
        type: script_based
    """
    
            with open(self.config_file, "w") as f:
                f.write(user_config)
    
            # Â§öÊ¨°Ë∞ÉÁî®get_existing_servers
            from config_manager.main import EnhancedConfigManager
>           manager = config_manager.main.EnhancedConfigManager()
E           NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_regression_prevention.py:268: NameError
_ TestConfigurationPersistenceRegression.test_modified_example_server_detection _

self = <python.tests.tool_connect_server.test_regression_prevention.TestConfigurationPersistenceRegression testMethod=test_modified_example_server_detection>

        def test_modified_example_server_detection(self):
            """ÊµãËØï‰øÆÊîπËøáÁöÑÁ§∫‰æãÊúçÂä°Âô®ËÉΩË¢´Ê≠£Á°ÆËØÜÂà´‰∏∫Áî®Êà∑ÈÖçÁΩÆ"""
            # ËÆæÁΩÆÊµãËØïÁéØÂ¢É
            os.environ['HOME'] = str(self.test_dir)
            self.config_dir.mkdir(parents=True, exist_ok=True)
    
            # ÂàõÂª∫‰øÆÊîπËøáÁöÑÁ§∫‰æãÊúçÂä°Âô®ÈÖçÁΩÆ
            modified_config = """servers:
      example-server:
        description: "ÊàëÁöÑÂºÄÂèëÊúçÂä°Âô®"
        host: dev.mycompany.com
        port: 2222
        username: developer
        type: script_based
    """
    
            with open(self.config_file, "w") as f:
                f.write(modified_config)
    
            # Âú®ÁÆÄÂåñÁâàÊú¨‰∏≠ÔºåÊàë‰ª¨‰∏ìÊ≥®‰∫éÈÖçÁΩÆÊñá‰ª∂ÁöÑÁ®≥ÂÆöÊÄß
            # ËÄå‰∏çÊòØÊô∫ËÉΩÊ£ÄÊµãÔºåÊâÄ‰ª•Ëøô‰∏™ÊµãËØïÈúÄË¶ÅÈÄÇÂ∫îÊñ∞ÁöÑËÆæËÆ°ÁêÜÂøµ
            from config_manager.main import EnhancedConfigManager
            manager = EnhancedConfigManager()
    
            # ÁÆÄÂåñÁâàÊú¨ÁöÑÊ†∏ÂøÉÁõÆÊ†áÔºö‰øùÊä§Áé∞ÊúâÈÖçÁΩÆ‰∏çË¢´Ë¶ÜÁõñ
            # ÊµãËØïÂ§öÊ¨°Ë∞ÉÁî®‰∏ç‰ºö‰øÆÊîπÁî®Êà∑ÈÖçÁΩÆ
            original_content = self.config_file.read_text()
    
            # Â§öÊ¨°Ë∞ÉÁî®Â∫îËØ•‰∏ç‰ºö‰øÆÊîπÈÖçÁΩÆ
            for _ in range(3):
>               manager.ensure_config_exists()
E               AttributeError: 'EnhancedConfigManager' object has no attribute 'ensure_config_exists'

python/tests/tool_connect_server/test_regression_prevention.py:180: AttributeError
___ TestConfigurationPersistenceRegression.test_npm_installation_protection ____

self = <python.tests.tool_connect_server.test_regression_prevention.TestConfigurationPersistenceRegression testMethod=test_npm_installation_protection>

        def test_npm_installation_protection(self):
            """ÊµãËØïNPMÂÆâË£ÖÂêéÁöÑÈÖçÁΩÆ‰øùÊä§Êú∫Âà∂"""
            # ËÆæÁΩÆÊµãËØïÁéØÂ¢É
            os.environ['HOME'] = str(self.test_dir)
            self.config_dir.mkdir(parents=True, exist_ok=True)
    
            # ÂàõÂª∫NPMÊ†áËÆ∞Êñá‰ª∂ÔºàÊ®°ÊãüÊñ∞ÂÆâË£ÖÔºâ
            npm_marker = self.config_dir / ".npm_install_marker"
            npm_marker.touch()
    
            # ÂàõÂª∫Âü∫Êú¨ÈÖçÁΩÆ
            basic_config = """servers:
      example-server:
        description: "Á§∫‰æãÊúçÂä°Âô®ÈÖçÁΩÆ"
        host: example.com
        port: 22
        username: your-username
        type: script_based
    """
    
            with open(self.config_file, "w") as f:
                f.write(basic_config)
    
            # Âú®ÁÆÄÂåñÁâàÊú¨‰∏≠ÔºåÊàë‰ª¨‰∏ìÊ≥®‰∫éÈÖçÁΩÆÁ®≥ÂÆöÊÄßËÄå‰∏çÊòØÂ§çÊùÇÁöÑNPMÊ£ÄÊµã
            from config_manager.main import EnhancedConfigManager
>           manager = config_manager.main.EnhancedConfigManager()
E           NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_regression_prevention.py:310: NameError
___________ TestSimpleAutomationDemo.test_multiple_validation_types ____________

self = <python.tests.tool_connect_server.test_simple_automated_demo.TestSimpleAutomationDemo testMethod=test_multiple_validation_types>

    def test_multiple_validation_types(self):
        """ÊµãËØïÂ§öÁßçÈ™åËØÅÁ±ªÂûãÁöÑËá™Âä®Âåñ"""
        print("\nüéØ ÊºîÁ§∫4: Â§öÁßçÈ™åËØÅÁ±ªÂûãËá™Âä®Âåñ")
    
        # ÊµãËØï‰∏ªÊú∫ÂêçÈ™åËØÅ
        with patch('builtins.input', return_value='test-host.com'):
            hostname = self.config_manager.smart_input(
                "‰∏ªÊú∫Âêç", validator=self.config_manager.validate_hostname
            )
        print(f"‚úÖ ‰∏ªÊú∫ÂêçÈ™åËØÅ: {hostname}")
    
        # ÊµãËØïÁ´ØÂè£È™åËØÅ
        with patch('builtins.input', return_value='22'):
            port = self.config_manager.smart_input(
                "Á´ØÂè£", validator=self.config_manager.validate_port
            )
        print(f"‚úÖ Á´ØÂè£È™åËØÅ: {port}")
    
        # ÊµãËØïÁî®Êà∑ÂêçÈ™åËØÅ
        with patch('builtins.input', return_value='testuser'):
            username = self.config_manager.smart_input(
                "Áî®Êà∑Âêç", validator=self.config_manager.validate_username
            )
        print(f"‚úÖ Áî®Êà∑ÂêçÈ™åËØÅ: {username}")
    
>       self.assertEqual(hostname, 'test-host.com')
E       AssertionError: None != 'test-host.com'

python/tests/tool_connect_server/test_simple_automated_demo.py:136: AssertionError
----------------------------- Captured stdout call -----------------------------

üéØ ÊºîÁ§∫4: Â§öÁßçÈ™åËØÅÁ±ªÂûãËá™Âä®Âåñ
ËæìÂÖ•È™åËØÅÂ§±Ë¥•ÔºöÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º„ÄÇÊ≠£Á°ÆÊ†ºÂºèÁ§∫‰æãÔºö192.168.1.100
‚úÖ ‰∏ªÊú∫ÂêçÈ™åËØÅ: None
ËæìÂÖ•È™åËØÅÂ§±Ë¥•ÔºöÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º„ÄÇÊ≠£Á°ÆÊ†ºÂºèÁ§∫‰æãÔºö192.168.1.100
‚úÖ Á´ØÂè£È™åËØÅ: None
ËæìÂÖ•È™åËØÅÂ§±Ë¥•ÔºöÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º„ÄÇÊ≠£Á°ÆÊ†ºÂºèÁ§∫‰æãÔºö192.168.1.100
‚úÖ Áî®Êà∑ÂêçÈ™åËØÅ: None
__________ TestSimpleAutomationDemo.test_smart_input_basic_automation __________

self = <python.tests.tool_connect_server.test_simple_automated_demo.TestSimpleAutomationDemo testMethod=test_smart_input_basic_automation>

    def test_smart_input_basic_automation(self):
        """ÊµãËØïsmart_inputÂü∫Êú¨Ëá™Âä®Âåñ"""
        print("\nüéØ ÊºîÁ§∫1: Âü∫Êú¨smart_inputËá™Âä®Âåñ")
    
        # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•
        user_inputs = ['192.168.1.100']
    
        with patch('builtins.input', side_effect=user_inputs):
            with patch('sys.stdout', new_callable=StringIO) as mock_stdout:
                result = self.config_manager.smart_input(
                    "üåê ÊúçÂä°Âô®Âú∞ÂùÄ",
                    validator=self.config_manager.validate_hostname
                )
                output = mock_stdout.getvalue()
    
        print(f"‚úÖ ËæìÂÖ•ÁªìÊûú: {result}")
        print(f"üìù ËæìÂá∫ÂÜÖÂÆπ: {output.strip()}")
    
>       self.assertEqual(result, '192.168.1.100')
E       AssertionError: None != '192.168.1.100'

python/tests/tool_connect_server/test_simple_automated_demo.py:55: AssertionError
----------------------------- Captured stdout call -----------------------------

üéØ ÊºîÁ§∫1: Âü∫Êú¨smart_inputËá™Âä®Âåñ
‚úÖ ËæìÂÖ•ÁªìÊûú: None
üìù ËæìÂá∫ÂÜÖÂÆπ: ËæìÂÖ•È™åËØÅÂ§±Ë¥•ÔºöÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º„ÄÇÊ≠£Á°ÆÊ†ºÂºèÁ§∫‰æãÔºö192.168.1.100
_____ TestSimpleAutomationDemo.test_smart_input_error_recovery_automation ______

self = <python.tests.tool_connect_server.test_simple_automated_demo.TestSimpleAutomationDemo testMethod=test_smart_input_error_recovery_automation>

    def test_smart_input_error_recovery_automation(self):
        """ÊµãËØïsmart_inputÈîôËØØÊÅ¢Â§çËá™Âä®Âåñ"""
        print("\nüéØ ÊºîÁ§∫2: ÈîôËØØÊÅ¢Â§çËá™Âä®Âåñ")
    
        # Ê®°ÊãüÁî®Êà∑ÂÖàËæìÂÖ•ÈîôËØØÔºåÁÑ∂ÂêéËæìÂÖ•Ê≠£Á°ÆÁöÑÂÄº
        user_inputs = [
            'invalid host with spaces',  # Á¨¨‰∏ÄÊ¨°ËæìÂÖ•ÈîôËØØ
            '192.168.1.101'             # Á¨¨‰∫åÊ¨°ËæìÂÖ•Ê≠£Á°Æ
        ]
    
        with patch('builtins.input', side_effect=user_inputs):
            with patch('sys.stdout', new_callable=StringIO) as mock_stdout:
                result = self.config_manager.smart_input(
                    "üåê ÊúçÂä°Âô®Âú∞ÂùÄ",
                    validator=self.config_manager.validate_hostname
                )
                output = mock_stdout.getvalue()
    
        print(f"‚úÖ ÊúÄÁªàÁªìÊûú: {result}")
        print(f"üìù ÈîôËØØÊèêÁ§∫Âá∫Áé∞: {'ËæìÂÖ•È™åËØÅÂ§±Ë¥•' in output}")
        print(f"üìù ËØ¶ÁªÜÊèêÁ§∫Âá∫Áé∞: {'ÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º' in output}")
    
>       self.assertEqual(result, '192.168.1.101')
E       AssertionError: None != '192.168.1.101'

python/tests/tool_connect_server/test_simple_automated_demo.py:79: AssertionError
----------------------------- Captured stdout call -----------------------------

üéØ ÊºîÁ§∫2: ÈîôËØØÊÅ¢Â§çËá™Âä®Âåñ
‚úÖ ÊúÄÁªàÁªìÊûú: None
üìù ÈîôËØØÊèêÁ§∫Âá∫Áé∞: True
üìù ËØ¶ÁªÜÊèêÁ§∫Âá∫Áé∞: True
______________ TestZeroInteractionDemo.test_batch_server_creation ______________

self = <python.tests.tool_connect_server.test_zero_interaction_demo.TestZeroInteractionDemo testMethod=test_batch_server_creation>

    def setUp(self):
        """ÊµãËØïÂâçÂáÜÂ§á"""
        self.temp_dir = tempfile.mkdtemp()
        self.config_file = Path(self.temp_dir) / 'config.yaml'
>       self.config_manager = config_manager.main.EnhancedConfigManager(str(self.config_file))
E       NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_zero_interaction_demo.py:28: NameError
__________ TestZeroInteractionDemo.test_completely_headless_operation __________

self = <python.tests.tool_connect_server.test_zero_interaction_demo.TestZeroInteractionDemo testMethod=test_completely_headless_operation>

    def setUp(self):
        """ÊµãËØïÂâçÂáÜÂ§á"""
        self.temp_dir = tempfile.mkdtemp()
        self.config_file = Path(self.temp_dir) / 'config.yaml'
>       self.config_manager = config_manager.main.EnhancedConfigManager(str(self.config_file))
E       NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_zero_interaction_demo.py:28: NameError
___________ TestZeroInteractionDemo.test_completely_silent_mcp_setup ___________

self = <python.tests.tool_connect_server.test_zero_interaction_demo.TestZeroInteractionDemo testMethod=test_completely_silent_mcp_setup>

    def setUp(self):
        """ÊµãËØïÂâçÂáÜÂ§á"""
        self.temp_dir = tempfile.mkdtemp()
        self.config_file = Path(self.temp_dir) / 'config.yaml'
>       self.config_manager = config_manager.main.EnhancedConfigManager(str(self.config_file))
E       NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_zero_interaction_demo.py:28: NameError
________ TestZeroInteractionDemo.test_mock_all_interactions_completely _________

self = <python.tests.tool_connect_server.test_zero_interaction_demo.TestZeroInteractionDemo testMethod=test_mock_all_interactions_completely>

    def setUp(self):
        """ÊµãËØïÂâçÂáÜÂ§á"""
        self.temp_dir = tempfile.mkdtemp()
        self.config_file = Path(self.temp_dir) / 'config.yaml'
>       self.config_manager = config_manager.main.EnhancedConfigManager(str(self.config_file))
E       NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_zero_interaction_demo.py:28: NameError
____________ TestZeroInteractionDemo.test_smart_input_with_defaults ____________

self = <python.tests.tool_connect_server.test_zero_interaction_demo.TestZeroInteractionDemo testMethod=test_smart_input_with_defaults>

    def setUp(self):
        """ÊµãËØïÂâçÂáÜÂ§á"""
        self.temp_dir = tempfile.mkdtemp()
        self.config_file = Path(self.temp_dir) / 'config.yaml'
>       self.config_manager = config_manager.main.EnhancedConfigManager(str(self.config_file))
E       NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_zero_interaction_demo.py:28: NameError
___________ TestZeroInteractionDemo.test_validation_with_auto_retry ____________

self = <python.tests.tool_connect_server.test_zero_interaction_demo.TestZeroInteractionDemo testMethod=test_validation_with_auto_retry>

    def setUp(self):
        """ÊµãËØïÂâçÂáÜÂ§á"""
        self.temp_dir = tempfile.mkdtemp()
        self.config_file = Path(self.temp_dir) / 'config.yaml'
>       self.config_manager = config_manager.main.EnhancedConfigManager(str(self.config_file))
E       NameError: name 'config_manager' is not defined

python/tests/tool_connect_server/test_zero_interaction_demo.py:28: NameError
____________________________ test_force_interactive ____________________________

    def test_force_interactive():
        """ÊµãËØïÂº∫Âà∂‰∫§‰∫íÊ®°Âºè"""
        print("üéØ ÊµãËØïÂº∫Âà∂‰∫§‰∫íÊ®°Âºè")
        print("=" * 50)
    
        # Ê®°ÊãüMCPÁéØÂ¢É
        os.environ['NO_COLOR'] = '1'
    
        print("1. ÊµãËØïÊôÆÈÄöÊ®°ÂºèÔºàÂ∫îËØ•Á¶ÅÁî®‰∫§‰∫íÔºâ")
>       manager1 = config_manager.main.EnhancedConfigManager()
E       NameError: name 'config_manager' is not defined

test_interactive_config.py:25: NameError
----------------------------- Captured stdout call -----------------------------
üéØ ÊµãËØïÂº∫Âà∂‰∫§‰∫íÊ®°Âºè
==================================================
1. ÊµãËØïÊôÆÈÄöÊ®°ÂºèÔºàÂ∫îËØ•Á¶ÅÁî®‰∫§‰∫íÔºâ
____________________ test_interactive_create_server_config _____________________

    def test_interactive_create_server_config():
        # ÊµãËØïÂâçÊ∏ÖÁêÜ
        if os.path.exists(TEST_CONFIG_PATH):
            os.remove(TEST_CONFIG_PATH)
        # patch input ÂÆûÁé∞Ëá™Âä®Âåñ‰∫§‰∫í
        with patch("builtins.input", side_effect=MOCK_INPUTS):
            manager = EnhancedConfigManager(config_path=TEST_CONFIG_PATH, force_interactive=True)
            with patch.object(manager.ia, 'smart_input', side_effect=lambda prompt, **kwargs: "22" if "Á´ØÂè£" in prompt else (MOCK_INPUTS.pop(0) if MOCK_INPUTS else "test")):
                manager.guided_setup()
        # Ê†°È™åÈÖçÁΩÆÂÜÖÂÆπ
        actual = load_yaml(TEST_CONFIG_PATH)
        expected = load_yaml(EXPECTED_CONFIG_PATH)
>       assert actual == expected, f"ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥\nÂÆûÈôÖ: {actual}\nÈ¢ÑÊúü: {expected}"
E       AssertionError: ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥
E         ÂÆûÈôÖ: {'servers': {'test_server': {}}}
E         È¢ÑÊúü: {'servers': {'test_server_001': {'host': 'test-host-001', 'username': 'testuser', 'port': 22, 'docker_enabled': False, 'docker_config': {}, 'auto_sync_enabled': False, 'sync_config': {}}}}
E       assert {'servers': {..._server': {}}} == {'servers': {...t-001', ...}}}
E         
E         Differing items:
E         {'servers': {'test_server': {}}} != {'servers': {'test_server_001': {'auto_sync_enabled': False, 'docker_config': {}, 'docker_enabled': False, 'host': 'test-host-001', ...}}}
E         
E         Full diff:
E           {
E               'servers': {...
E         
E         ...Full output truncated (14 lines hidden), use '-vv' to show

tests/tool_add_server_config/test_interactive_create_server_config.py:49: AssertionError
________________ test_interactive_create_server_config_prefill _________________

    def test_interactive_create_server_config_prefill():
        # ÊµãËØïÂâçÊ∏ÖÁêÜ
        if os.path.exists(TEST_CONFIG_PATH):
            os.remove(TEST_CONFIG_PATH)
        # È¢ÑÂ°´ÂèÇÊï∞
        prefill = {
            'name': 'hg225',
            'host': '192.168.1.225',
            'username': 'admin',
        }
        with patch("builtins.input", side_effect=MOCK_INPUTS):
            manager = EnhancedConfigManager(config_path=TEST_CONFIG_PATH, force_interactive=True)
            with patch.object(manager.ia, 'smart_input', side_effect=lambda prompt, **kwargs: "22" if "Á´ØÂè£" in prompt else (MOCK_INPUTS.pop(0) if MOCK_INPUTS else "test")):
                manager.guided_setup(prefill=prefill)
        # Ê†°È™åÈÖçÁΩÆÂÜÖÂÆπ
        actual = load_yaml(TEST_CONFIG_PATH)
        expected = load_yaml(EXPECTED_CONFIG_PATH)
>       assert actual == expected, f"ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥\nÂÆûÈôÖ: {actual}\nÈ¢ÑÊúü: {expected}"
E       AssertionError: ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥
E         ÂÆûÈôÖ: {'servers': {'test_server': {'host': '192.168.1.225', 'name': 'hg225', 'username': 'admin'}}}
E         È¢ÑÊúü: {'servers': {'hg225': {'host': '192.168.1.225', 'username': 'admin', 'port': 22, 'docker_enabled': False, 'docker_config': {}, 'auto_sync_enabled': False, 'sync_config': {}}}}
E       assert {'servers': {...e': 'admin'}}} == {'servers': {...1.225', ...}}}
E         
E         Differing items:
E         {'servers': {'test_server': {'host': '192.168.1.225', 'name': 'hg225', 'username': 'admin'}}} != {'servers': {'hg225': {'auto_sync_enabled': False, 'docker_config': {}, 'docker_enabled': False, 'host': '192.168.1.225', ...}}}
E         
E         Full diff:
E           {
E               'servers': {...
E         
E         ...Full output truncated (13 lines hidden), use '-vv' to show

tests/tool_add_server_config/test_interactive_create_server_config_prefill.py:51: AssertionError
__________ TestConfigUXPrefillFix.test_guided_setup_for_relay_server ___________

self = <test_fix_config_ux_and_prefill_bug.TestConfigUXPrefillFix testMethod=test_guided_setup_for_relay_server>

    def test_guided_setup_for_relay_server(self):
        """
        Êñ∞Â¢ûÊµãËØïÔºöÈÄöËøáÂêëÂØºÊ®°ÂºèÊõ¥Êñ∞‰∫åÁ∫ßË∑≥ÊùøÊúçÂä°Âô®ÔºåÁ°Æ‰øùË∞ÉÁî®_configure_serverÊó∂‰∏çÂÜçÂá∫Èîô„ÄÇ
        """
        # Ê®°ÊãüÁî®Êà∑ÈÄöËøá guided_setup Êõ¥Êñ∞ hg222
        inputs = [
            '1', # 1. RelayË∑≥ÊùøÊú∫ËøûÊé•
            'hg222-guided', # ÊúçÂä°Âô®ÂêçÁß∞
            '2', # 2. ‰∫åÁ∫ßË∑≥Êùø
            # 3. ÈÖçÁΩÆÁ¨¨‰∏ÄÁ∫ßË∑≥ÊùøÊú∫
            "relay@relay-host.com",
            "22",
            "relay_pass",
            # 4. ÈÖçÁΩÆÊúÄÁªàÁõÆÊ†áÊúçÂä°Âô®
            "target@target-host.com",
            "2222",
            "target_pass",
            # 5. ‰∏çÈÖçÁΩÆDocker
            "n",
            # 6. Á°ÆËÆ§‰øùÂ≠ò
            "y"
        ]
    
        # ‰ΩøÁî®Ëá™Âä®Âåñ‰∫§‰∫íÊµãËØïÂ∑•ÂÖ∑Êù•ËøêË°å
        # Ê≥®ÊÑèÔºöËøôÈáåÊàë‰ª¨‰∏çÁõ¥Êé•Ë∞ÉÁî® --editÔºåËÄåÊòØÊ®°Êãü‰ªé‰∏ªËèúÂçïËøõÂÖ•ÂêëÂØº
>       tester = AutomatedInteractionTester(
            target_script='enhanced_config_manager.py',
            inputs=inputs,
            script_args=['--config', str(self.config_path), '--mode', 'guided']
        )
E       TypeError: __init__() got an unexpected keyword argument 'target_script'

tests/tool_delete_server_config/test_fix_config_ux_and_prefill_bug.py:146: TypeError
_____ TestConfigUXPrefillFix.test_update_relay_server_with_prefill_issues ______

self = <test_fix_config_ux_and_prefill_bug.TestConfigUXPrefillFix testMethod=test_update_relay_server_with_prefill_issues>

    def test_update_relay_server_with_prefill_issues(self):
        """
        ÊµãËØïÊõ¥Êñ∞‰∫åÁ∫ßË∑≥ÊùøÊúçÂä°Âô®ÁöÑÊµÅÁ®ãÔºåÁ°Æ‰øùÔºö
        1. UXÊòØÁÆÄÊ¥ÅÁöÑ user@host -> password Ê®°Âºè„ÄÇ
        2. È¢ÑÂ°´ÂÖÖ‰∏çÂÆåÊï¥ÁöÑÂèÇÊï∞‰∏ç‰ºöÂØºËá¥Â¥©Ê∫É„ÄÇ
        """
        # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Â∫èÂàó
        inputs = [
            "hg222",  # 1. ÈÄâÊã©Ë¶ÅÁºñËæëÁöÑÊúçÂä°Âô®
            "y",      # 2. Á°ÆËÆ§ÁºñËæë
            # 3. ÈÖçÁΩÆÁ¨¨‰∏ÄÁ∫ßË∑≥ÊùøÊú∫ (Relay Host)
            "user1@relay-host.com",
            "22",
            "relay_password_123",
            # 4. ÈÖçÁΩÆÊúÄÁªàÁõÆÊ†áÊúçÂä°Âô® (Jump Host)
            "user2@final-dest.com",
            "2222",
            "final_dest_password_456",
            "n" # 5.‰∏çÈÖçÁΩÆDOCKER
        ]
    
        # ‰ΩøÁî®Ëá™Âä®Âåñ‰∫§‰∫íÊµãËØïÂ∑•ÂÖ∑Êù•ËøêË°å
>       tester = AutomatedInteractionTester(
            target_script='enhanced_config_manager.py',
            inputs=inputs,
            script_args=['--config', str(self.config_path), '--edit', 'hg222']
        )
E       TypeError: __init__() got an unexpected keyword argument 'target_script'

tests/tool_delete_server_config/test_fix_config_ux_and_prefill_bug.py:88: TypeError
____________ TestMCPToolingFramework.test_reproduce_original_issue _____________

self = <test_fix_example_mcp_testing_20240622.TestMCPToolingFramework object at 0x1075a8eb0>

    @pytest.mark.asyncio
    async def test_reproduce_original_issue(self):
        """
        Â§çÁé∞ÂéüÂßãÈóÆÈ¢òÁöÑÊúÄÂ∞èÊ°à‰æã
    
        ÂÅáËÆæÈóÆÈ¢òÔºöMCPÂ∑•ÂÖ∑Ë∞ÉÁî®Êó∂Êó†Ê≥ïÊ≠£Á°ÆÂ§ÑÁêÜÈîôËØØÂìçÂ∫î
        """
        # ËøôÈáåÊòØÈóÆÈ¢òÂ§çÁé∞ÈÄªËæëÁöÑÁ§∫‰æã
        # Âú®ÂÆûÈôÖ‰ΩøÁî®‰∏≠ÔºåËøôÈáåÂ∫îËØ•ÂåÖÂê´ËÉΩÂ§üÂ§çÁé∞ÂéüÂßãÈóÆÈ¢òÁöÑÊúÄÂ∞è‰ª£Á†Å
    
        client = create_mcp_test_client()
    
        # Â∞ùËØïË∞ÉÁî®‰∏çÂ≠òÂú®ÁöÑÂ∑•ÂÖ∑ÔºåÂ∫îËØ•ÂæóÂà∞ÊòéÁ°ÆÁöÑÈîôËØØ‰ø°ÊÅØ
        with pytest.raises(MCPTestError) as exc_info:
            await client.call_tool("non_existent_tool")
    
        # È™åËØÅÈîôËØØ‰ø°ÊÅØÊòØÂê¶ÂåÖÂê´ÊúüÊúõÁöÑÂÜÖÂÆπ
>       assert "non_existent_tool" in str(exc_info.value) or "‰∏çÂ≠òÂú®" in str(exc_info.value)
E       assert ('non_existent_tool' in "MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n" or '‰∏çÂ≠òÂú®' in "MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n")
E        +  where "MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n" = str(MCPTestError("MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n"))
E        +    where MCPTestError("MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n") = <ExceptionInfo MCPTestError("MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n") tblen=2>.value
E        +  and   "MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n" = str(MCPTestError("MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n"))
E        +    where MCPTestError("MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n") = <ExceptionInfo MCPTestError("MCPÊúçÂä°Âô®ÈîôËØØ: /Applications/Xcode.app/Contents/Developer/usr/bin/python3: can't open file '/Users/xuyehua/Code/remote-terminal-mcp/python/python/mcp_server.py': [Errno 2] No such file or directory\n") tblen=2>.value

tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py:50: AssertionError
________ TestMCPToolingFramework.test_integration_with_other_components ________

self = <test_fix_example_mcp_testing_20240622.TestMCPToolingFramework object at 0x1075ac4c0>

    @pytest.mark.asyncio
    async def test_integration_with_other_components(self):
        """
        Á°Æ‰øù‰øÆÂ§ç‰∏çÂΩ±ÂìçÂÖ∂‰ªñÂäüËÉΩ
    
        ÊµãËØïMCPÂ∑•ÂÖ∑Ë∞ÉÁî®‰∏éÂÖ∂‰ªñÁªÑ‰ª∂ÁöÑÈõÜÊàê
        """
        async with create_test_environment() as test_env:
            client = create_mcp_test_client()
    
            # ÂàõÂª∫ÊµãËØïÈÖçÁΩÆ
            test_config = {
                "servers": {
                    "test-server": {
                        "type": "ssh",
                        "host": "localhost",
                        "user": "testuser",
                        "port": 22
                    }
                }
            }
    
            test_env.create_test_config("test-server", test_config)
    
            # ÊµãËØïÈÖçÁΩÆËØªÂèñÂäüËÉΩ
            try:
                servers = await client.call_tool("list_servers", {}, timeout=3.0)
                # Â∫îËØ•ËÉΩÂ§üËØªÂèñÂà∞ÈÖçÁΩÆÔºàÊàñÁªôÂá∫ÂêàÁêÜÁöÑÈîôËØØ‰ø°ÊÅØÔºâ
                assert isinstance(servers, (list, str))
    
            except MCPTestError as e:
                # ÈîôËØØ‰ø°ÊÅØÂ∫îËØ•ÊúâÊÑè‰πâ
                error_msg = str(e)
                assert len(error_msg) > 0
    
            # ÊµãËØïÊúçÂä°Âô®‰ø°ÊÅØËé∑Âèñ
            try:
>               if isinstance(servers, list) and len(servers) > 0:
E               UnboundLocalError: local variable 'servers' referenced before assignment

tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py:138: UnboundLocalError
_ TestMCPRestartAndNewCodeLoading.test_new_update_server_config_logic_loading __

self = <test_fix_mcp_restart_and_new_code_loading_20241222.TestMCPRestartAndNewCodeLoading testMethod=test_new_update_server_config_logic_loading>

    def test_new_update_server_config_logic_loading(self):
        """ÊµãËØïÊñ∞ÁöÑupdate_server_configÈÄªËæëÊòØÂê¶Ê≠£Á°ÆÂä†ËΩΩ"""
        print("üéØ ÊµãËØïÊñ∞ÁöÑupdate_server_configÈÄªËæëÂä†ËΩΩ")
    
        # Ê£ÄÊü•‰ª£Á†Å‰∏≠ÊòØÂê¶ÂåÖÂê´Êñ∞ÁöÑÈÄªËæëÊ†áËÆ∞
        with open(self.mcp_server_path, 'r', encoding='utf-8') as f:
            content = f.read()
    
        # È™åËØÅÊñ∞ÈÄªËæëÊ†áËÆ∞Â≠òÂú®
>       self.assertIn("NEW UPDATE LOGIC", content,
            "‰ª£Á†Å‰∏≠Â∫îËØ•ÂåÖÂê´Êñ∞ÁöÑupdate_server_configÈÄªËæëÊ†áËÆ∞")
E       AssertionError: 'NEW UPDATE LOGIC' not found in '#!/usr/bin/env python3\n"""\nRemote Terminal MCP Server\n\nMCP server focused on remote server connections, session management and command execution\n"""\n\nimport asyncio\nimport json\nimport sys\nimport os\nimport subprocess\nimport traceback\nfrom pathlib import Path\nfrom datetime import datetime\nimport yaml\n\n# Ê∑ªÂä†È°πÁõÆÊ†πÁõÆÂΩïÂà∞Ë∑ØÂæÑÔºå‰ª•‰æøÂØºÂÖ•enhanced_config_manager\nproject_root = Path(__file__).parent.parent\nsys.path.insert(0, str(project_root))\n\n# ÊõøÊç¢ÂéüÊúâÂØºÂÖ•\n#from config_manager.main import EnhancedConfigManager\nfrom python.config_manager.main import EnhancedConfigManager\n# ‰øÆÂ§çÂØºÂÖ•Ë∑ØÂæÑ - enhanced_ssh_managerÂú®pythonÁõÆÂΩï‰∏ã\nsys.path.insert(0, str(Path(__file__).parent))\nfrom enhanced_ssh_manager import EnhancedSSHManager, log_output, create_enhanced_manager\n\n# ÂØºÂÖ•coloramaÁî®‰∫éÂΩ©Ëâ≤ËæìÂá∫ÊîØÊåÅ\ntry:\n    from colorama import Fore, Style, init\n    init()  # ÂàùÂßãÂåñcolorama\nexcept ImportError:\n    # Â¶ÇÊûúcolorama‰∏çÂèØÁî®ÔºåÂàõÂª∫Á©∫ÁöÑÊõø‰ª£\n    class Fore:\n        CYAN = ""\n        GREEN = ""\n        RED = ""\n        YELLOW = ""\n        WHITE = ""\n    class Style:\n        RESET_ALL = ""\n\n# ÊúçÂä°Âô®‰ø°ÊÅØ\nSERVER_NAME = "remote-terminal-mcp"\nSERVER_VERSION = "0.7.0-mcp-integrated-config"\n\n# ËÆæÁΩÆÂÆâÈùôÊ®°ÂºèÔºåÈò≤Ê≠¢SSH ManagerÊòæÁ§∫ÂêØÂä®ÊëòË¶Å\nos.environ[\'MCP_QUIET\'] = \'1\'\n\n# Ë∞ÉËØïÊ®°Âºè\nDEBUG = os.getenv(\'MCP_DEBUG\', \'0\') == \'1\'\n\ndef debug_log(msg):\n    """ÊîπËøõÁöÑË∞ÉËØïÊó•ÂøóÂáΩÊï∞ÔºåÈÅøÂÖçstderrËæìÂá∫Ë¢´ËØØÊ†áËÆ∞‰∏∫ÈîôËØØ"""\n    if DEBUG:\n        # Âè™Âú®ÊòéÁ°ÆÂêØÁî®Ë∞ÉËØïÊ®°ÂºèÊó∂ÊâçËæìÂá∫\n        print(f"[DEBUG] {msg}", file=sys.stderr, flush=True)\n\ndef info_log(msg):\n    """‰ø°ÊÅØÁ∫ßÂà´Êó•ÂøóÔºåËæìÂá∫Âà∞stderr‰ΩÜ‰∏ç‰ºöË¢´ËØØÊ†áËÆ∞"""\n    # ‰ΩøÁî®Êõ¥Ê∏©ÂíåÁöÑ‰ø°ÊÅØËæìÂá∫ÔºåÈÅøÂÖçÂú®Ê≠£Â∏∏ËøêË°åÊó∂‰∫ßÁîüÈîôËØØÁ∫ßÂà´Êó•Âøó\n    pass  # Âú®MCPÁéØÂ¢É‰∏≠ÔºåÊàë‰ª¨Â∞ΩÈáè‰øùÊåÅÈùôÈªò\n\ndef create_success_response(request_id, text_content):\n    """ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÊñáÊú¨ÂÜÖÂÆπÁöÑÊàêÂäüJSON-RPCÂìçÂ∫î"""\n    return {\n        "jsonrpc": "2.0",\n        "id": request_id,\n        "result": {\n            "contentType": "text/plain",\n            "content": text_content\n        }\n    }\n\ndef create_error_response(request_id, code, message):\n    """ÂàõÂª∫‰∏Ä‰∏™Ê†áÂáÜÁöÑJSON-RPCÈîôËØØÂìçÂ∫î"""\n    return {\n        "jsonrpc": "2.0",\n        "id": request_id,\n        "error": {\n            "code": code,\n            "message": message\n        }\n    }\n\ndef run_command(cmd, cwd=None, timeout=30):\n    """Execute commandÂπ∂ËøîÂõûÁªìÊûú"""\n    try:\n        debug_log(f"Running command: {cmd}")\n        result = subprocess.run(\n            cmd, \n            shell=True, \n            capture_output=True, \n            text=True, \n            timeout=timeout,\n            cwd=cwd\n        )\n        \n        output = ""\n        if result.stdout:\n            output += f"Output:\\n{result.stdout}\\n"\n        if result.stderr:\n            output += f"Error output:\\n{result.stderr}\\n"\n        \n        output += f"Exit code: {result.returncode}"\n        \n        return output, result.returncode == 0\n        \n    except subprocess.TimeoutExpired:\n        return f"Command execution timeout ({timeout}s)", False\n    except Exception as e:\n        return f"Command execution failed: {str(e)}", False\n\ndef create_tools_list():\n    """ÂàõÂª∫Â∑•ÂÖ∑ÂàóË°®ÔºåÂü∫‰∫éSSH ManagerÁöÑÂÆûÈôÖÂäüËÉΩ"""\n    return [\n        {\n            "name": "list_servers",\n            "description": "List all available remote servers configured in the system",\n            "inputSchema": {\n                "type": "object",\n                "properties": {},\n                "required": []\n            }\n        },\n        {\n            "name": "connect_server", \n            "description": "Connect to a remote server by name",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "server_name": {\n                        "type": "string",\n                        "description": "Name of the server to connect to"\n                    }\n                },\n                "required": ["server_name"]\n            }\n        },\n        {\n            "name": "disconnect_server",\n            "description": "Disconnect from a remote server and clean up resources",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "server_name": {\n                        "type": "string",\n                        "description": "Name of the server to disconnect from"\n                    },\n                    "force": {\n                        "type": "boolean",\n                        "description": "Force disconnect even if there are active sessions (default: false)",\n                        "default": False\n                    }\n                },\n                "required": ["server_name"]\n            }\n        },\n        {\n            "name": "execute_command",\n            "description": "Execute a command on a server",\n            "inputSchema": {\n                "type": "object", \n                "properties": {\n                    "command": {\n                        "type": "string",\n                        "description": "Command to execute"\n                    },\n                    "server": {\n                        "type": "string",\n                        "description": "Server name (optional, uses default if not specified)"\n                    }\n                },\n                "required": ["command"]\n            }\n        },\n        {\n            "name": "get_server_status",\n            "description": "Get connection status of servers",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "server_name": {\n                        "type": "string", \n                        "description": "Server name (optional, gets all if not specified)"\n                    }\n                },\n                "required": []\n            }\n        },\n        {\n            "name": "get_server_info",\n            "description": "Get detailed configuration information for a specific server",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "server_name": {\n                        "type": "string",\n                        "description": "Name of the server to get detailed information for"\n                    }\n                },\n                "required": ["server_name"]\n            }\n        },\n        {\n            "name": "run_local_command",\n            "description": "Execute a command on the local system",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "cmd": {\n                        "type": "string",\n                        "description": "Command to execute locally"\n                    },\n                    "cwd": {\n                        "type": "string",\n                        "description": "Working directory (optional)"\n                    },\n                    "timeout": {\n                        "type": "number",\n                        "description": "Timeout in seconds (default: 30)"\n                    }\n                },\n                "required": ["cmd"]\n            }\n        },\n        # ÈÖçÁΩÆÁÆ°ÁêÜÂ∑•ÂÖ∑ - interactive_config_wizardÂäüËÉΩÂ∑≤ÂÜÖÁΩÆÂà∞create/updateÂ∑•ÂÖ∑‰∏≠\n        {\n            "name": "diagnose_connection",\n            "description": "Diagnose connection issues and provide troubleshooting suggestions for a specific server",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "server_name": {\n                        "type": "string",\n                        "description": "Name of the server to diagnose"\n                    },\n                    "include_network_test": {\n                        "type": "boolean",\n                        "description": "Include network connectivity tests (ping, SSH)",\n                        "default": True\n                    },\n                    "include_config_validation": {\n                        "type": "boolean",\n                        "description": "Include configuration validation",\n                        "default": True\n                    }\n                },\n                "required": ["server_name"]\n            }\n        },\n        {\n            "name": "create_server_config",\n            "description": "üöÄ Êô∫ËÉΩÊúçÂä°Âô®ÈÖçÁΩÆÂàõÂª∫Â∑•ÂÖ∑ - ÊîØÊåÅÂÖ≥ÈîÆËØçËØÜÂà´ÂíåÂèÇÊï∞ÂåñÈÖçÁΩÆ„ÄÇüåü Êñ∞Á≠ñÁï•ÔºöÂç≥‰ΩøÊèê‰æõ‰∫ÜÂèÇÊï∞Ôºå‰πüÈªòËÆ§ËøõÂÖ•‰∫§‰∫íÁïåÈù¢ÔºàÂèÇÊï∞‰Ωú‰∏∫È¢ÑÂ°´ÂÖÖÈªòËÆ§ÂÄºÔºâÔºåÁ°Æ‰øùÁî®Êà∑ÂØπÈÖçÁΩÆÊúâÂÆåÂÖ®ÁöÑÊéßÂà∂ÊùÉÂíåÂèØËßÅÊÄß„ÄÇüîç Êô∫ËÉΩÂàáÊç¢ÔºöËá™Âä®Ê£ÄÊµãÊúçÂä°Âô®ÊòØÂê¶Â∑≤Â≠òÂú®ÔºåÂ¶ÇÂ≠òÂú®ÂàôËá™Âä®ÂàáÊç¢Âà∞Êõ¥Êñ∞Ê®°Âºè„ÄÇÂèØ‰ª•ÈÄöËøáËá™ÁÑ∂ËØ≠Ë®ÄÊèèËø∞ÊàñÁõ¥Êé•Êèê‰æõÈÖçÁΩÆÂèÇÊï∞Êù•ÂàõÂª∫ÊúçÂä°Âô®„ÄÇ",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "prompt": {\n                        "type": "string",\n                        "description": "Áî®Êà∑ÁöÑÈÖçÁΩÆÈúÄÊ±ÇÊèèËø∞ÔºåÊîØÊåÅËá™ÁÑ∂ËØ≠Ë®Ä„ÄÇ‰æãÂ¶ÇÔºö\'ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÊúçÂä°Âô®ÈÖçÁΩÆ\'„ÄÅ\'ÊàëÊÉ≥Ê∑ªÂä†‰∏ÄÂè∞ÊúçÂä°Âô®\'Á≠â"\n                    },\n                    "name": {\n                        "type": "string",\n                        "description": "ÊúçÂä°Âô®ÂêçÁß∞ÔºàÂîØ‰∏ÄÊ†áËØÜÁ¨¶Ôºâ"\n                    },\n                    "host": {\n                        "type": "string",\n                        "description": "ÊúçÂä°Âô®‰∏ªÊú∫ÂêçÊàñIPÂú∞ÂùÄ"\n                    },\n                    "username": {\n                        "type": "string",\n                        "description": "SSHËøûÊé•Áî®Êà∑Âêç"\n                    },\n                    "port": {\n                        "type": "integer",\n                        "description": "SSHÁ´ØÂè£Âè∑",\n                        "default": 22\n                    },\n                    "connection_type": {\n                        "type": "string",\n                        "description": "ËøûÊé•Á±ªÂûãÔºösshÔºàÁõ¥ËøûÔºâÊàñrelayÔºàÈÄöËøárelay-cliÔºâ",\n                        "enum": ["ssh", "relay"],\n                        "default": "ssh"\n                    },\n                    "description": {\n                        "type": "string",\n                        "description": "ÊúçÂä°Âô®ÊèèËø∞‰ø°ÊÅØ"\n                    },\n                    "relay_target_host": {\n                        "type": "string",\n                        "description": "ÂΩì‰ΩøÁî®relayËøûÊé•Êó∂ÁöÑÁõÆÊ†á‰∏ªÊú∫"\n                    },\n                    "docker_enabled": {\n                        "type": "boolean",\n                        "description": "ÊòØÂê¶ÂêØÁî®DockerÂÆπÂô®ÊîØÊåÅ",\n                        "default": False\n                    },\n                    "docker_image": {\n                        "type": "string",\n                        "description": "DockerÈïúÂÉèÂêçÁß∞ÔºàÂΩìdocker_enabled=trueÊó∂‰ΩøÁî®Ôºâ",\n                        "default": "ubuntu:20.04"\n                    },\n                    "docker_container": {\n                        "type": "string",\n                        "description": "DockerÂÆπÂô®ÂêçÁß∞ÔºàÂΩìdocker_enabled=trueÊó∂‰ΩøÁî®Ôºâ"\n                    },\n                    "docker_ports": {\n                        "type": "array",\n                        "items": {"type": "string"},\n                        "description": "DockerÁ´ØÂè£Êò†Â∞ÑÂàóË°®ÔºåÊ†ºÂºèÔºö[\\"host:container\\"]Ôºå‰æãÂ¶ÇÔºö[\\"8080:8080\\", \\"5000:5000\\"]",\n                        "default": ["8080:8080", "8888:8888", "6006:6006"]\n                    },\n                    "docker_volumes": {\n                        "type": "array",\n                        "items": {"type": "string"},\n                        "description": "DockerÂç∑ÊåÇËΩΩÂàóË°®ÔºåÊ†ºÂºèÔºö[\\"host:container\\"]Ôºå‰æãÂ¶ÇÔºö[\\"/home:/home\\", \\"/data:/data\\"]",\n                        "default": ["/home:/home", "/data:/data"]\n                    },\n                    "docker_shell": {\n                        "type": "string",\n                        "description": "DockerÂÆπÂô®ÂÜÖ‰ΩøÁî®ÁöÑshellÔºå‰æãÂ¶ÇÔºöbash, zsh, sh",\n                        "default": "bash"\n                    },\n                    "docker_auto_create": {\n                        "type": "boolean",\n                        "description": "ÊòØÂê¶Ëá™Âä®ÂàõÂª∫DockerÂÆπÂô®ÔºàÂ¶ÇÊûú‰∏çÂ≠òÂú®Ôºâ",\n                        "default": True\n                    },\n                    # Ëá™Âä®ÂêåÊ≠•ÈÖçÁΩÆÂèÇÊï∞\n                    "auto_sync_enabled": {\n                        "type": "boolean",\n                        "description": "ÊòØÂê¶ÂêØÁî®Ëá™Âä®ÂêåÊ≠•ÂäüËÉΩÔºà‰ΩøÁî®proftpdÔºâ",\n                        "default": False\n                    },\n                    "sync_remote_workspace": {\n                        "type": "string",\n                        "description": "ËøúÁ®ãÂ∑•‰ΩúÁõÆÂΩïË∑ØÂæÑ",\n                        "default": "/home/Code"\n                    },\n                    "sync_ftp_port": {\n                        "type": "integer",\n                        "description": "FTPÊúçÂä°Á´ØÂè£",\n                        "default": 8021\n                    },\n                    "sync_ftp_user": {\n                        "type": "string",\n                        "description": "FTPÁî®Êà∑Âêç",\n                        "default": "ftpuser"\n                    },\n                    "sync_ftp_password": {\n                        "type": "string",\n                        "description": "FTPÂØÜÁ†Å",\n                        "default": "sync_password"\n                    },\n                    "sync_local_workspace": {\n                        "type": "string",\n                        "description": "Êú¨Âú∞Â∑•‰ΩúÁõÆÂΩïË∑ØÂæÑÔºàÁ©∫Ë°®Á§∫ÂΩìÂâçÁõÆÂΩïÔºâ",\n                        "default": ""\n                    },\n                    "auto_detect": {\n                        "type": "boolean",\n                        "description": "Ëá™Âä®Ê£ÄÊµãÁî®Êà∑ÊÑèÂõæ",\n                        "default": True\n                    },\n                    "confirm_create": {\n                        "type": "boolean",\n                        "description": "Á°ÆËÆ§ÂàõÂª∫ÈÖçÁΩÆÔºàÂΩìÈÖçÁΩÆÂÆåÊï¥Êó∂‰ΩøÁî®Ôºâ",\n                        "default": False\n                    },\n                    "interactive": {\n                        "type": "boolean",\n                        "description": "ÊòØÂê¶ÂêØÁî®‰∫§‰∫íÂºèÊ®°Âºè„ÄÇÈªòËÆ§trueÔºöÂç≥‰ΩøÊèê‰æõ‰∫ÜÂèÇÊï∞‰πüËøõÂÖ•‰∫§‰∫íÁïåÈù¢ÔºàÂèÇÊï∞‰Ωú‰∏∫ÈªòËÆ§ÂÄºÔºâ„ÄÇËÆæÁΩÆfalseÔºöË∑≥Ëøá‰∫§‰∫íÁïåÈù¢Áõ¥Êé•ÂàõÂª∫ÈÖçÁΩÆ",\n                        "default": True\n                    },\n                    "cursor_interactive": {\n                        "type": "boolean",\n                        "description": "ÂêØÁî®CursorËÅäÂ§©ÁïåÈù¢ÂÜÖ‰∫§‰∫íÊ®°ÂºèÔºàÊé®ËçêÔºâ- Áõ¥Êé•Âú®ËÅäÂ§©ÁïåÈù¢ÊòæÁ§∫ÂΩ©Ëâ≤ÈÖçÁΩÆË°®ÂçïÔºåÊó†ÈúÄÂàáÊç¢Á™óÂè£",\n                        "default": False\n                    }\n                },\n                "required": []\n            }\n        },\n        {\n            "name": "update_server_config",\n            "description": "Update an existing server configuration with new parameters. Includes built-in interactive wizard when no update fields are provided.",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "server_name": {\n                        "type": "string",\n                        "description": "Name of the server to update"\n                    },\n                    "host": {\n                        "type": "string",\n                        "description": "Server hostname or IP address"\n                    },\n                    "username": {\n                        "type": "string",\n                        "description": "Username for SSH connection"\n                    },\n                    "port": {\n                        "type": "integer",\n                        "description": "SSH port"\n                    },\n                    "connection_type": {\n                        "type": "string",\n                        "description": "Connection type: ssh (direct) or relay (via relay-cli)",\n                        "enum": ["ssh", "relay"]\n                    },\n                    "description": {\n                        "type": "string",\n                        "description": "Server description"\n                    },\n                    "relay_target_host": {\n                        "type": "string",\n                        "description": "Target host when using relay connection"\n                    },\n                    "docker_enabled": {\n                        "type": "boolean",\n                        "description": "Enable Docker container support"\n                    },\n                    "docker_image": {\n                        "type": "string",\n                        "description": "Docker image for auto-creation"\n                    },\n                    "docker_container": {\n                        "type": "string",\n                        "description": "Docker container name"\n                    },\n                    "docker_ports": {\n                        "type": "array",\n                        "items": {"type": "string"},\n                        "description": "DockerÁ´ØÂè£Êò†Â∞ÑÂàóË°®ÔºåÊ†ºÂºèÔºö[\\"host:container\\"]Ôºå‰æãÂ¶ÇÔºö[\\"8080:8080\\", \\"5000:5000\\"]",\n                        "default": ["8080:8080", "8888:8888", "6006:6006"]\n                    },\n                    "docker_volumes": {\n                        "type": "array",\n                        "items": {"type": "string"},\n                        "description": "DockerÂç∑ÊåÇËΩΩÂàóË°®ÔºåÊ†ºÂºèÔºö[\\"host:container\\"]Ôºå‰æãÂ¶ÇÔºö[\\"/home:/home\\", \\"/data:/data\\"]",\n                        "default": ["/home:/home", "/data:/data"]\n                    },\n                    "docker_shell": {\n                        "type": "string",\n                        "description": "DockerÂÆπÂô®ÂÜÖ‰ΩøÁî®ÁöÑshellÔºå‰æãÂ¶ÇÔºöbash, zsh, sh",\n                        "default": "bash"\n                    },\n                    "docker_auto_create": {\n                        "type": "boolean",\n                        "description": "ÊòØÂê¶Ëá™Âä®ÂàõÂª∫DockerÂÆπÂô®ÔºàÂ¶ÇÊûú‰∏çÂ≠òÂú®Ôºâ",\n                        "default": True\n                    },\n                    # Ëá™Âä®ÂêåÊ≠•ÈÖçÁΩÆÂèÇÊï∞\n                    "auto_sync_enabled": {\n                        "type": "boolean",\n                        "description": "ÊòØÂê¶ÂêØÁî®Ëá™Âä®ÂêåÊ≠•ÂäüËÉΩÔºà‰ΩøÁî®proftpdÔºâ"\n                    },\n                    "sync_remote_workspace": {\n                        "type": "string",\n                        "description": "ËøúÁ®ãÂ∑•‰ΩúÁõÆÂΩïË∑ØÂæÑ"\n                    },\n                    "sync_ftp_port": {\n                        "type": "integer",\n                        "description": "FTPÊúçÂä°Á´ØÂè£"\n                    },\n                    "sync_ftp_user": {\n                        "type": "string",\n                        "description": "FTPÁî®Êà∑Âêç"\n                    },\n                    "sync_ftp_password": {\n                        "type": "string",\n                        "description": "FTPÂØÜÁ†Å"\n                    },\n                    "sync_local_workspace": {\n                        "type": "string",\n                        "description": "Êú¨Âú∞Â∑•‰ΩúÁõÆÂΩïË∑ØÂæÑÔºàÁ©∫Ë°®Á§∫ÂΩìÂâçÁõÆÂΩïÔºâ"\n                    },\n                    "show_current_config": {\n                        "type": "boolean",\n                        "description": "Show current configuration and update guidance (for wizard mode)",\n                        "default": True\n                    }\n                },\n                "required": ["server_name"]\n            }\n        },\n        {\n            "name": "delete_server_config",\n            "description": "Delete a server configuration permanently. This action cannot be undone.",\n            "inputSchema": {\n                "type": "object",\n                "properties": {\n                    "server_name": {\n                        "type": "string",\n                        "description": "Name of the server to delete"\n                    },\n                    "confirm": {\n                        "type": "boolean",\n                        "description": "Confirmation flag to prevent accidental deletion (default: false)",\n                        "default": False\n                    }\n                },\n                "required": ["server_name"]\n            }\n        }\n    ]\n\ndef send_response(response_obj):\n    """ÂèëÈÄÅÁ∫ØJSONÂìçÂ∫îÔºàÂÖºÂÆπCursorÔºâ"""\n    try:\n        message_str = json.dumps(response_obj)\n        # Áõ¥Êé•ËæìÂá∫JSONÔºå‰∏ç‰ΩøÁî®Content-LengthÂ§¥ÈÉ®\n        sys.stdout.write(message_str + \'\\n\')\n        sys.stdout.flush()\n        # ÁßªÈô§debug_logË∞ÉÁî®ÔºåÈÅøÂÖçstderrËæìÂá∫\n        if DEBUG:\n            print(f"[DEBUG] Sent JSON response for ID {response_obj.get(\'id\')}", file=sys.stderr, flush=True)\n    except BrokenPipeError:\n        # ÈùôÈªòÂ§ÑÁêÜBrokenPipeErrorÔºåÈÅøÂÖç‰∏çÂøÖË¶ÅÁöÑÈîôËØØÊó•Âøó\n        if DEBUG:\n            print("[DEBUG] Failed to send response: Broken pipe. Parent process likely exited.", file=sys.stderr, flush=True)\n        pass\n\n\n\n\nasync def handle_request(request):\n    """Â§ÑÁêÜMCPËØ∑Ê±Ç"""\n    method = request.get("method", "")\n    params = request.get("params")\n    request_id = request.get("id")\n    \n    # Âè™Âú®Ë∞ÉËØïÊ®°Âºè‰∏ãËÆ∞ÂΩïËØ∑Ê±Ç‰ø°ÊÅØ\n    if DEBUG:\n        print(f"[DEBUG] Received request: method=\'{method}\', id=\'{request_id}\'", file=sys.stderr, flush=True)\n    \n    # Â§ÑÁêÜÈÄöÁü•ÔºàÊ≤°ÊúâidÁöÑËØ∑Ê±ÇÔºâ\n    if request_id is None:\n        if method.lower() == "initialized":\n            if DEBUG:\n                print("[DEBUG] Received \'initialized\' notification - handshake complete", file=sys.stderr, flush=True)\n            return None\n        # ÂÖ∂‰ªñÈÄöÁü•‰πüÁõ¥Êé•ËøîÂõûNoneÔºà‰∏çÈúÄË¶ÅÂìçÂ∫îÔºâ\n        return None\n\n    try:\n        # Normalize method name to be case-insensitive\n        method_lower = method.lower()\n\n        if method_lower == "initialize":\n            if DEBUG:\n                print("[DEBUG] Handling \'initialize\' request.", file=sys.stderr, flush=True)\n            \n            # ÂÆåÂÖ®Á¨¶ÂêàLSPÂíåMCPËßÑËåÉÁöÑcapabilities\n            server_capabilities = {\n                "tools": {\n                    "listChanged": True\n                },\n                "resources": {\n                    "subscribe": True,\n                    "listChanged": True\n                },\n                "prompts": {\n                    "listChanged": True\n                },\n                "sampling": {}\n            }\n            \n            response = {\n                "jsonrpc": "2.0",\n                "id": request_id,\n                "result": {\n                    "protocolVersion": "2024-11-05",\n                    "capabilities": server_capabilities,\n                    "serverInfo": {\n                        "name": SERVER_NAME,\n                        "version": SERVER_VERSION\n                    }\n                }\n            }\n            return response\n        \n        elif method_lower == "shutdown":\n            if DEBUG:\n                print("[DEBUG] Handling \'shutdown\' request.", file=sys.stderr, flush=True)\n            response = { "jsonrpc": "2.0", "id": request_id, "result": {} }\n            return response\n        \n        elif method_lower == "tools/list":\n            if DEBUG:\n                print("[DEBUG] Handling \'tools/list\' request.", file=sys.stderr, flush=True)\n            tools = create_tools_list()\n            response = {\n                "jsonrpc": "2.0",\n                "id": request_id,\n                "result": { "tools": tools }\n            }\n            return response\n\n        elif method_lower == "listofferings":\n            if DEBUG:\n                print("[DEBUG] Handling \'ListOfferings\' request.", file=sys.stderr, flush=True)\n            response = {\n                "jsonrpc": "2.0",\n                "id": request_id,\n                "result": {\n                    "offerings": []\n                }\n            }\n            return response\n\n        elif method_lower == "tools/call":\n            tool_name = params.get("name")\n            tool_arguments = params.get("arguments", {})\n            # Âè™Âú®Ë∞ÉËØïÊ®°Âºè‰∏ãËÆ∞ÂΩïÂ∑•ÂÖ∑ÊâßË°å‰ø°ÊÅØ\n            if DEBUG:\n                print(f"[DEBUG] Executing tool \'{tool_name}\' with arguments: {tool_arguments}", file=sys.stderr, flush=True)\n            \n            try:\n                # Áªü‰∏Ä‰ΩøÁî®create_enhanced_managerÂ∑•ÂéÇÂáΩÊï∞\n                manager = create_enhanced_manager()  # ‰ΩøÁî®Â¢ûÂº∫ÁâàSSHÁÆ°ÁêÜÂô®\n                config_manager = config_manager.main.EnhancedConfigManager()\n                content = ""\n                \n                # list_serversÂ∑•ÂÖ∑ÈÄÇÈÖçÊñ∞ÂÆûÁé∞\n                if tool_name == "list_servers":\n                    try:\n                        manager = config_manager.main.EnhancedConfigManager()\n                        servers = manager.list_servers()\n                        content = json.dumps({"servers": servers}, ensure_ascii=False, indent=2)\n                    except Exception as e:\n                        debug_log(f"list_servers error: {str(e)}")\n                        content = json.dumps({"error": str(e)}, ensure_ascii=False, indent=2)\n                        \n                elif tool_name == "connect_server":\n                    server_name = tool_arguments.get("server_name")\n                    if server_name:\n                        # üöÄ ‰ΩøÁî®Êñ∞ÁöÑconnect.pyËøûÊé•ÁÆ°ÁêÜÂô®\n                        try:\n                            from python.connect import connect_server as new_connect_server\n                            result = new_connect_server(server_name)\n                            \n                            if result.success:\n                                content = f"‚úÖ ËøûÊé•ÊàêÂäüÔºÅ\\nüìù ËØ¶ÊÉÖ: {result.message}\\n\\nüéØ ËøûÊé•‰ø°ÊÅØ:\\n"\n                                if result.session_name:\n                                    content += f"‚Ä¢ ‰ºöËØùÂêçÁß∞: {result.session_name}\\n"\n                                    content += f"‚Ä¢ ËøûÊé•ÁªàÁ´Ø: tmux attach -t {result.session_name}\\n"\n                                    content += f"‚Ä¢ ÂàÜÁ¶ª‰ºöËØù: Ctrl+B, ÁÑ∂ÂêéÊåâ D\\n"\n                                if result.details:\n                                    content += f"‚Ä¢ ËøûÊé•Á±ªÂûã: {result.details.get(\'connection_type\', \'Êú™Áü•\')}\\n"\n                                    content += f"‚Ä¢ ÁõÆÊ†á‰∏ªÊú∫: {result.details.get(\'host\', \'Êú™Áü•\')}\\n"\n                                    if result.details.get(\'docker_container\'):\n                                        content += f"‚Ä¢ DockerÂÆπÂô®: {result.details.get(\'docker_container\')}\\n"\n                                content += f"\\nüöÄ Êñ∞Êû∂ÊûÑÁâπÊÄß:\\n‚Ä¢ ÂàÜÁ¶ªÂÖ≥Ê≥®ÁÇπËÆæËÆ°\\n‚Ä¢ Â¢ûÂº∫ÁöÑrelayËÆ§ËØÅÂ§ÑÁêÜ\\n‚Ä¢ Êô∫ËÉΩ‰∫§‰∫íÂºïÂØº\\n‚Ä¢ ÂÅ•Â∫∑Áä∂ÊÄÅÊ£ÄÊµã"\n                            else:\n                                content = f"‚ùå ËøûÊé•Â§±Ë¥•: {result.message}"\n                                if result.details and result.details.get(\'tmux_command\'):\n                                    content += f"\\n\\nüí° ÊâãÂä®ËøûÊé•: {result.details[\'tmux_command\']}"\n                        except ImportError as e:\n                            # ÈôçÁ∫ßÂà∞ÂéüÊúâÂÆûÁé∞\n                            success, message = manager.smart_connect(server_name)\n                            if success:\n                                server = manager.get_server(server_name)\n                                session_name = server.session.get(\'name\', f"{server_name}_session") if server and server.session else f"{server_name}_session"\n                                content = f"‚úÖ ËøûÊé•ÊàêÂäüÔºàÂÖºÂÆπÊ®°ÂºèÔºâ: {message}\\nüéØ ËøûÊé•: tmux attach -t {session_name}"\n                            else:\n                                content = f"‚ùå ËøûÊé•Â§±Ë¥•: {message}"\n                        except Exception as e:\n                            content = f"‚ùå ËøûÊé•ÂºÇÂ∏∏: {str(e)}"\n                    else:\n                        content = "Error: server_name parameter is required"\n                        \n                elif tool_name == "disconnect_server":\n                    server_name = tool_arguments.get("server_name")\n                    force = tool_arguments.get("force", False)\n                    \n                    if server_name:\n                        try:\n                            from python.connect import disconnect_server as new_disconnect_server\n                            result = new_disconnect_server(server_name)\n                            \n                            if result.success:\n                                content = f"‚úÖ Êñ≠ÂºÄËøûÊé•ÊàêÂäü\\nüìù ËØ¶ÊÉÖ: {result.message}\\nüéØ ÊúçÂä°Âô®: {server_name}"\n                            else:\n                                content = f"‚ùå Êñ≠ÂºÄËøûÊé•Â§±Ë¥•: {result.message}"\n                        except ImportError:\n                            # ÈôçÁ∫ßÂà∞ÂéüÊúâÂÆûÁé∞\n                            try:\n                                server = manager.get_server(server_name)\n                                if not server:\n                                    content = f"‚ùå ÊúçÂä°Âô® \'{server_name}\' ‰∏çÂ≠òÂú®"\n                                else:\n                                    disconnect_result = manager.disconnect_server(server_name, force=force)\n                                    if disconnect_result.get(\'success\', False):\n                                        content = f"‚úÖ ÊàêÂäüÊñ≠ÂºÄËøûÊé•: {server_name}"\n                                    else:\n                                        content = f"‚ùå Êñ≠ÂºÄËøûÊé•Â§±Ë¥•: {disconnect_result.get(\'error\', \'Êú™Áü•ÈîôËØØ\')}"\n                            except Exception as e:\n                                content = f"‚ùå Êñ≠ÂºÄËøûÊé•ÂºÇÂ∏∏: {str(e)}"\n                        except Exception as e:\n                            content = f"‚ùå Êñ≠ÂºÄËøûÊé•ÂºÇÂ∏∏: {str(e)}"\n                    else:\n                        content = "Error: server_name parameter is required"\n                        \n                elif tool_name == "execute_command":\n                    command = tool_arguments.get("command")\n                    server = tool_arguments.get("server")\n                    if command:\n                        try:\n                            from python.connect import execute_server_command\n                            result = execute_server_command(server or "default", command)\n                            \n                            if result.success:\n                                content = f"‚úÖ ÂëΩ‰ª§ÊâßË°åÊàêÂäü\\n\\nüìã ÂëΩ‰ª§: {command}\\n\\nüìÑ ËæìÂá∫:\\n{result.details.get(\'output\', \'Êó†ËæìÂá∫\') if result.details else \'Êó†ËæìÂá∫\'}"\n                            else:\n                                content = f"‚ùå ÂëΩ‰ª§ÊâßË°åÂ§±Ë¥•: {result.message}"\n                        except ImportError:\n                            # ÈôçÁ∫ßÂà∞ÂéüÊúâÂÆûÁé∞\n                            result = manager.execute_command(server or "default", command)\n                            content = str(result)\n                        except Exception as e:\n                            content = f"‚ùå ÂëΩ‰ª§ÊâßË°åÂºÇÂ∏∏: {str(e)}"\n                    else:\n                        content = "Error: command parameter is required"\n                        \n                elif tool_name == "get_server_status":\n                    server_name = tool_arguments.get("server_name")\n                    if server_name:\n                        try:\n                            from python.connect import get_server_status as new_get_server_status\n                            result = new_get_server_status(server_name)\n                            \n                            if result.success:\n                                content = f"üìä ÊúçÂä°Âô®Áä∂ÊÄÅ: {server_name}\\n"\n                                content += f"üîó Áä∂ÊÄÅ: {result.status.value}\\n"\n                                content += f"üìù ËØ¶ÊÉÖ: {result.message}\\n"\n                                if result.session_name:\n                                    content += f"üéØ ‰ºöËØù: {result.session_name}"\n                            else:\n                                content = f"‚ùå Ëé∑ÂèñÁä∂ÊÄÅÂ§±Ë¥•: {result.message}"\n                        except ImportError:\n                            # ÈôçÁ∫ßÂà∞ÂéüÊúâÂÆûÁé∞\n                            status = manager.get_connection_status(server_name)\n                            content = json.dumps(status, ensure_ascii=False, indent=2)\n                        except Exception as e:\n                            content = f"‚ùå Ëé∑ÂèñÁä∂ÊÄÅÂºÇÂ∏∏: {str(e)}"\n                    else:\n                        # Ëé∑ÂèñÊâÄÊúâÊúçÂä°Âô®Áä∂ÊÄÅ\n                        try:\n                            from python.connect import list_all_servers\n                            servers_info = list_all_servers()\n                            \n                            if servers_info:\n                                content = "üìä ÊâÄÊúâÊúçÂä°Âô®Áä∂ÊÄÅ:\\n\\n"\n                                for server in servers_info:\n                                    status_icon = {"connected": "üü¢", "ready": "‚úÖ", "disconnected": "üî¥", "error": "‚ùå"}.get(server[\'status\'], "‚ùì")\n                                    content += f"{status_icon} **{server[\'name\']}**\\n"\n                                    content += f"   üìç ‰∏ªÊú∫: {server[\'host\']}\\n"\n                                    content += f"   üë§ Áî®Êà∑: {server[\'username\']}\\n"\n                                    content += f"   üîó Áä∂ÊÄÅ: {server[\'status\']}\\n"\n                                    if server.get(\'docker_container\'):\n                                        content += f"   üê≥ ÂÆπÂô®: {server[\'docker_container\']}\\n"\n                                    content += "\\n"\n                            else:\n                                content = "üìã ÊöÇÊó†ÈÖçÁΩÆÁöÑÊúçÂä°Âô®"\n                        except ImportError:\n                            # ÈôçÁ∫ßÂà∞ÂéüÊúâÂÆûÁé∞\n                            all_status = {}\n                            servers = manager.list_servers()\n                            for server in servers:\n                                server_name = server.get(\'name\')\n                                if server_name:\n                                    all_status[server_name] = manager.get_connection_status(server_name)\n                            content = json.dumps(all_status, ensure_ascii=False, indent=2)\n                        except Exception as e:\n                            content = f"‚ùå Ëé∑ÂèñÊúçÂä°Âô®ÂàóË°®ÂºÇÂ∏∏: {str(e)}"\n                    \n                elif tool_name == "get_server_info":\n                    server_name = tool_arguments.get("server_name")\n                    if server_name:\n                        try:\n                            # Ëé∑ÂèñÊúçÂä°Âô®ËØ¶ÁªÜÈÖçÁΩÆ‰ø°ÊÅØ\n                            servers = config_manager.get_existing_servers()\n                            if server_name in servers:\n                                server_info = servers[server_name]\n                                # Ê∑ªÂä†ËøûÊé•Áä∂ÊÄÅ‰ø°ÊÅØ\n                                connection_status = manager.get_connection_status(server_name)\n                                server_info[\'connection_status\'] = connection_status\n                                content = json.dumps(server_info, ensure_ascii=False, indent=2)\n                            else:\n                                content = json.dumps({\n                                    "error": f"Server \'{server_name}\' not found",\n                                    "available_servers": list(servers.keys())\n                                }, ensure_ascii=False, indent=2)\n                        except Exception as e:\n                            content = json.dumps({\n                                "error": f"Failed to get server info: {str(e)}"\n                            }, ensure_ascii=False, indent=2)\n                    else:\n                        content = json.dumps({\n                            "error": "server_name parameter is required"\n                        }, ensure_ascii=False, indent=2)\n                \n                elif tool_name == "run_local_command":\n                    cmd = tool_arguments.get("cmd")\n                    cwd = tool_arguments.get("cwd")\n                    timeout = tool_arguments.get("timeout", 30)\n                    if cmd:\n                        output, success = run_command(cmd, cwd, timeout)\n                        content = output\n                    else:\n                        content = "Error: cmd parameter is required"\n                \n                # interactive_config_wizardÂäüËÉΩÂ∑≤ÂÜÖÁΩÆÂà∞create_server_configÂíåupdate_server_config‰∏≠\n                elif tool_name == "diagnose_connection":\n                    server_name = tool_arguments.get("server_name")\n                    include_network_test = tool_arguments.get("include_network_test", True)\n                    include_config_validation = tool_arguments.get("include_config_validation", True)\n                    \n                    if server_name:\n                        try:\n                            # ‰ΩøÁî®Â¢ûÂº∫ÁâàSSHÁÆ°ÁêÜÂô®ÁöÑËØäÊñ≠ÂäüËÉΩ\n                            diagnosis = manager.diagnose_connection_problem(server_name)\n                            \n                            # Â¶ÇÊûúÈúÄË¶ÅÔºåÊ∑ªÂä†È¢ùÂ§ñÁöÑÁΩëÁªúÊµãËØï\n                            if include_network_test:\n                                diagnosis["network_tests"] = "Network connectivity tests included"\n                            \n                            if include_config_validation:\n                                diagnosis["config_validation"] = "Configuration validation included"\n                            \n                            content = json.dumps(diagnosis, ensure_ascii=False, indent=2)\n                            \n                        except Exception as e:\n                            content = json.dumps({\n                                "error": f"Diagnosis failed: {str(e)}",\n                                "server_name": server_name,\n                                "suggestions": [\n                                    "Verify server name is correct",\n                                    "Check if server configuration exists",\n                                    "Ensure network connectivity to the server"\n                                ]\n                            }, ensure_ascii=False, indent=2)\n                    else:\n                        content = json.dumps({\n                            "error": "server_name parameter is required"\n                        }, ensure_ascii=False, indent=2)\n                \n                # create_server_configÂ∑•ÂÖ∑ÈÄÇÈÖçÊñ∞ÂÆûÁé∞\n                elif tool_name == "create_server_config":\n                    try:\n                        manager = config_manager.main.EnhancedConfigManager()\n                        server_info = tool_arguments.copy()\n                        name, server_cfg = manager.create_server(server_info)\n                        content = f"‚úÖ ÊúçÂä°Âô® {name} Â∑≤ÂàõÂª∫\\nÈÖçÁΩÆ: {json.dumps(server_cfg, ensure_ascii=False, indent=2)}"\n                    except Exception as e:\n                        debug_log(f"create_server_config error: {str(e)}")\n                        content = json.dumps({"error": str(e)}, ensure_ascii=False, indent=2)\n                \n                # update_server_configÂ∑•ÂÖ∑ÈÄÇÈÖçÊñ∞ÂÆûÁé∞\n                elif tool_name == "update_server_config":\n                    try:\n                        manager = config_manager.main.EnhancedConfigManager()\n                        name = tool_arguments.get("name")\n                        update_info = tool_arguments.copy()\n                        update_info.pop("name", None)\n                        updated_cfg = manager.update_server(name, update_info)\n                        content = f"‚úÖ ÊúçÂä°Âô® {name} Â∑≤Êõ¥Êñ∞\\nÈÖçÁΩÆ: {json.dumps(updated_cfg, ensure_ascii=False, indent=2)}"\n                    except Exception as e:\n                        debug_log(f"update_server_config error: {str(e)}")\n                        content = json.dumps({"error": str(e)}, ensure_ascii=False, indent=2)\n                \n                elif tool_name == "delete_server_config":\n                    try:\n                        server_name = tool_arguments.get("server_name")\n                        confirm = tool_arguments.get("confirm", False)\n                        \n                        if not server_name:\n                            content = json.dumps({\n                                "error": "server_name parameter is required"\n                            }, ensure_ascii=False, indent=2)\n                        elif not confirm:\n                            content = json.dumps({\n                                "error": "Deletion requires confirmation. Set \'confirm\' parameter to true.",\n                                "warning": "This action cannot be undone. The server configuration will be permanently deleted."\n                            }, ensure_ascii=False, indent=2)\n                        else:\n                            # Âà†Èô§ÊúçÂä°Âô®ÈÖçÁΩÆ\n                            mcp_config_manager = config_manager.main.EnhancedConfigManager()\n                            servers = mcp_config_manager.get_existing_servers()\n                            \n                            if server_name not in servers:\n                                content = json.dumps({\n                                    "error": f"Server \'{server_name}\' not found",\n                                    "available_servers": list(servers.keys())\n                                }, ensure_ascii=False, indent=2)\n                            else:\n                                try:\n                                    # ËØªÂèñÂΩìÂâçÈÖçÁΩÆ\n                                    import yaml\n                                    with open(mcp_config_manager.config_path, \'r\', encoding=\'utf-8\') as f:\n                                        current_config = yaml.safe_load(f)\n                                    \n                                    if not current_config:\n                                        current_config = {"servers": {}}\n                                    \n                                    # Âà†Èô§ÊåáÂÆöÊúçÂä°Âô®\n                                    if "servers" in current_config and server_name in current_config["servers"]:\n                                        deleted_config = current_config["servers"][server_name]\n                                        del current_config["servers"][server_name]\n                                        \n                                        # ‰øùÂ≠òÊõ¥Êñ∞ÂêéÁöÑÈÖçÁΩÆ\n                                        mcp_config_manager.save_config(current_config, merge=False)\n                                        \n                                        content = json.dumps({\n                                            "success": True,\n                                            "message": f"Server \'{server_name}\' deleted successfully",\n                                            "deleted_config": deleted_config,\n                                            "remaining_servers": list(current_config.get("servers", {}).keys())\n                                        }, ensure_ascii=False, indent=2)\n                                    else:\n                                        content = json.dumps({\n                                            "error": f"Server \'{server_name}\' not found in configuration"\n                                        }, ensure_ascii=False, indent=2)\n                                        \n                                except Exception as delete_error:\n                                    content = json.dumps({\n                                        "error": f"Failed to delete server config: {str(delete_error)}"\n                                    }, ensure_ascii=False, indent=2)\n                                    \n                    except Exception as e:\n                        content = json.dumps({\n                            "error": f"Failed to delete server config: {str(e)}"\n                        }, ensure_ascii=False, indent=2)\n                \n                elif tool_name == "diagnose_connection":\n                    server_name = tool_arguments.get("server_name")\n                    \n                    if not server_name:\n                        content = "Error: server_name is required for diagnosis"\n                    else:\n                        try:\n                            # ‰ΩøÁî®ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÁöÑÊµãËØïËøûÊé•ÂäüËÉΩ\n                            result = config_manager.test_connection()\n                            content = f"üîç ËøûÊé•ËØäÊñ≠ÂäüËÉΩÂ∑≤ÂêØÂä®ÔºåËØ∑Âú®ÈÖçÁΩÆÁÆ°ÁêÜÁïåÈù¢‰∏≠ÈÄâÊã©ÊúçÂä°Âô® \'{server_name}\' ËøõË°åÊµãËØï"\n                        except Exception as e:\n                            content = f"‚ùå ÂêØÂä®ËøûÊé•ËØäÊñ≠Â§±Ë¥•: {str(e)}"\n                \n                else:\n                    content = f"Unknown tool: {tool_name}"\n                \n                response = {\n                    "jsonrpc": "2.0",\n                    "id": request_id,\n                    "result": {\n                        "content": [\n                            {\n                                "type": "text",\n                                "text": content\n                            }\n                        ]\n                    }\n                }\n                \n            except Exception as e:\n                debug_log(f"Tool execution error: {e}\\n{traceback.format_exc()}")\n                response = create_error_response(request_id, -32603, f"Error executing tool \'{tool_name}\': {e}")\n            \n            return response\n\n        else:\n            response = create_error_response(request_id, -32601, f"Unknown method: {method}")\n            return response\n            \n    except Exception as e:\n        error_msg = f"An unexpected error occurred: {e}"\n        debug_log(f"{error_msg}\\n{traceback.format_exc()}")\n        response = create_error_response(request_id, -32603, error_msg)\n        return response\n\nasync def main():\n    """‰∏ª‰∫ã‰ª∂Âæ™ÁéØ"""\n    if DEBUG:\n        print(f"[DEBUG] Starting MCP Python Server v{SERVER_VERSION}", file=sys.stderr, flush=True)\n    \n    loop = asyncio.get_event_loop()\n\n    # 1. ËÆæÁΩÆÂºÇÊ≠•ËØªÂèñÂô® (stdin)\n    reader = asyncio.StreamReader()\n    protocol = asyncio.StreamReaderProtocol(reader)\n    await loop.connect_read_pipe(lambda: protocol, sys.stdin)\n\n    if DEBUG:\n        print("[DEBUG] Entering main while-loop to process messages.", file=sys.stderr, flush=True)\n    while True:\n        try:\n            line_bytes = await reader.readline()\n            if not line_bytes:\n                await asyncio.sleep(1) # prevent busy-looping on closed stdin\n                continue\n\n            line = line_bytes.decode(\'utf-8\').strip()\n            \n            if not line:\n                continue\n\n            try:\n                request = json.loads(line)\n                response = await handle_request(request)\n                \n                if response:\n                    # ÂèëÈÄÅÁ∫ØJSONÂìçÂ∫î\n                    send_response(response)\n\n            except json.JSONDecodeError as e:\n                debug_log(f"JSON Decode Error: {e}. Body was: \'{line}\'")\n            except Exception as e:\n                debug_log(f"Error processing line: {e}")\n                debug_log(traceback.format_exc())\n\n        except asyncio.CancelledError:\n            debug_log("Main loop cancelled.")\n            break\n        except Exception as e:\n            debug_log(f"Critical error in main loop: {e}")\n            debug_log(traceback.format_exc())\n            # In case of a critical error, sleep a bit to prevent a tight error loop\n            await asyncio.sleep(1)\n\nif __name__ == "__main__":\n    # Ê£ÄÊü•ÊòØÂê¶ÊòØÊµãËØïÊ®°Âºè\n    if len(sys.argv) > 1 and sys.argv[1] == "--test":\n        print("üß™ MCPÊúçÂä°Âô®ÊµãËØïÊ®°Âºè")\n        try:\n            # ÊµãËØïÂØºÂÖ•\n            from config_manager.main import EnhancedConfigManager\n            from enhanced_ssh_manager import EnhancedSSHManager\n            print("‚úÖ ÊâÄÊúâÊ®°ÂùóÂØºÂÖ•ÊàêÂäü")\n            \n            # ÊµãËØïÈÖçÁΩÆÁÆ°ÁêÜÂô®\n            config_manager = config_manager.main.EnhancedConfigManager()\n            servers = config_manager.get_existing_servers()\n            print(f"‚úÖ ÈÖçÁΩÆÁÆ°ÁêÜÂô®Â∑•‰ΩúÊ≠£Â∏∏ÔºåÂèëÁé∞ {len(servers)} ‰∏™ÊúçÂä°Âô®")\n            \n            # ÊµãËØïSSHÁÆ°ÁêÜÂô®\n            # Áªü‰∏Ä‰ΩøÁî®create_enhanced_managerÂ∑•ÂéÇÂáΩÊï∞\n            ssh_manager = create_enhanced_manager()\n            print("‚úÖ SSHÁÆ°ÁêÜÂô®ÂàùÂßãÂåñÊàêÂäü")\n            \n            print("üéâ ÊâÄÊúâÊµãËØïÈÄöËøáÔºÅMCPÊúçÂä°Âô®ÂèØ‰ª•Ê≠£Â∏∏ÂêØÂä®")\n            sys.exit(0)\n            \n        except Exception as e:\n            print(f"‚ùå ÊµãËØïÂ§±Ë¥•: {e}")\n            import traceback\n            traceback.print_exc()\n            sys.exit(1)\n    \n    try:\n        asyncio.run(main())\n    except KeyboardInterrupt:\n        debug_log("Server shut down by KeyboardInterrupt.")\n    except Exception as e:\n        tb_str = traceback.format_exc()\n        debug_log(f"Unhandled exception in top-level: {e}\\n{tb_str}")' : ‰ª£Á†Å‰∏≠Â∫îËØ•ÂåÖÂê´Êñ∞ÁöÑupdate_server_configÈÄªËæëÊ†áËÆ∞

tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py:259: AssertionError
----------------------------- Captured stdout call -----------------------------
üéØ ÊµãËØïÊñ∞ÁöÑupdate_server_configÈÄªËæëÂä†ËΩΩ
________ QualityAssuranceRulesTest.test_regression_directory_structure _________

self = <test_fix_quality_assurance_rules_20240622.QualityAssuranceRulesTest testMethod=test_regression_directory_structure>

    def test_regression_directory_structure(self):
        """ÊµãËØï1ÔºöÈ™åËØÅÂõûÂΩíÊµãËØïÁõÆÂΩïÁªìÊûÑÂÆåÊï¥ÊÄß"""
        print("üß™ ÊµãËØïÂõûÂΩíÊµãËØïÁõÆÂΩïÁªìÊûÑ...")
    
        # È™åËØÅÂõûÂΩíÊµãËØïÁõÆÂΩïÂ≠òÂú®
>       self.assertTrue(
            self.regression_dir.exists(),
            "ÂõûÂΩíÊµãËØïÁõÆÂΩï tests/regression/ ÂøÖÈ°ªÂ≠òÂú®"
        )
E       AssertionError: False is not true : ÂõûÂΩíÊµãËØïÁõÆÂΩï tests/regression/ ÂøÖÈ°ªÂ≠òÂú®

tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py:42: AssertionError
----------------------------- Captured stdout call -----------------------------
üß™ ÊµãËØïÂõûÂΩíÊµãËØïÁõÆÂΩïÁªìÊûÑ...
_______ QualityAssuranceRulesTest.test_regression_test_naming_convention _______

self = <test_fix_quality_assurance_rules_20240622.QualityAssuranceRulesTest testMethod=test_regression_test_naming_convention>

    def test_regression_test_naming_convention(self):
        """ÊµãËØï2ÔºöÈ™åËØÅÊµãËØïÊñá‰ª∂ÂëΩÂêçËßÑËåÉ"""
        print("üß™ ÊµãËØïÂõûÂΩíÊµãËØïÊñá‰ª∂ÂëΩÂêçËßÑËåÉ...")
    
        # Ëé∑ÂèñÊâÄÊúâÂõûÂΩíÊµãËØïÊñá‰ª∂
        test_files = list(self.regression_dir.glob("test_fix_*.py"))
    
        # È™åËØÅËá≥Â∞ëÊúâ‰∏Ä‰∏™ÂõûÂΩíÊµãËØïÊñá‰ª∂
>       self.assertGreater(
            len(test_files), 0,
            "ÂøÖÈ°ªËá≥Â∞ëÊúâ‰∏Ä‰∏™ÂõûÂΩíÊµãËØïÊñá‰ª∂"
        )
E       AssertionError: 0 not greater than 0 : ÂøÖÈ°ªËá≥Â∞ëÊúâ‰∏Ä‰∏™ÂõûÂΩíÊµãËØïÊñá‰ª∂

tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py:71: AssertionError
----------------------------- Captured stdout call -----------------------------
üß™ ÊµãËØïÂõûÂΩíÊµãËØïÊñá‰ª∂ÂëΩÂêçËßÑËåÉ...
___ TestMCPSilentConfigRegression.test_constructor_without_force_interactive ___

self = <test_mcp_silent_config_regression.TestMCPSilentConfigRegression testMethod=test_constructor_without_force_interactive>

    def test_constructor_without_force_interactive(self):
        """ÊµãËØïÊûÑÈÄ†ÂáΩÊï∞‰∏çÂÜçÈúÄË¶Åforce_interactiveÂèÇÊï∞"""
        # ÊµãËØïÈªòËÆ§ÊûÑÈÄ†
>       config_manager = config_manager.main.EnhancedConfigManager(str(self.config_file))
E       UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_list_servers/test_mcp_silent_config_regression.py:48: UnboundLocalError
____ TestMCPSilentConfigRegression.test_smart_input_detailed_error_messages ____

self = <test_mcp_silent_config_regression.TestMCPSilentConfigRegression testMethod=test_smart_input_detailed_error_messages>

    def test_smart_input_detailed_error_messages(self):
        """ÊµãËØïsmart_inputÁöÑËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ"""
        # Ê®°ÊãüÈùûMCPÊ®°Âºè
        self.config_manager.is_mcp_mode = False
    
        # ÊµãËØï‰∏ªÊú∫Âú∞ÂùÄÈ™åËØÅ
        with patch('builtins.input', side_effect=['invalid host', '192.168.1.100']):
            with patch('sys.stdout', new_callable=StringIO) as mock_stdout:
                result = self.config_manager.smart_input(
                    "üåê ÊúçÂä°Âô®Âú∞ÂùÄ",
                    validator=self.config_manager.validate_hostname
                )
    
                output = mock_stdout.getvalue()
                self.assertIn('ËæìÂÖ•È™åËØÅÂ§±Ë¥•', output)
                self.assertIn('ÊúçÂä°Âô®Âú∞ÂùÄ‰∏çËÉΩÂåÖÂê´Á©∫Ê†º', output)
                self.assertIn('Ê≠£Á°ÆÊ†ºÂºèÁ§∫‰æã', output)
>               self.assertEqual(result, '192.168.1.100')
E               AssertionError: None != '192.168.1.100'

tests/tool_list_servers/test_mcp_silent_config_regression.py:153: AssertionError
________ TestSyncConfigUIEnhancement.test_collect_sync_patterns_add_new ________

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_collect_sync_patterns_add_new>
mock_colored_print = <MagicMock name='colored_print' id='4422456560'>
mock_smart_input = <MagicMock name='smart_input' id='4428093616'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    def test_collect_sync_patterns_add_new(self, mock_colored_print, mock_smart_input):
        """ÊµãËØï7: _collect_sync_patternsÊñπÊ≥ïÊ∑ªÂä†Êñ∞Ê®°Âºè"""
        log_test_output("ÊµãËØï7: _collect_sync_patternsÊ∑ªÂä†Êñ∞Ê®°Âºè", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
>           config_manager = config_manager.main.EnhancedConfigManager()
E           UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:275: UnboundLocalError

During handling of the above exception, another exception occurred:

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_collect_sync_patterns_add_new>
mock_colored_print = <MagicMock name='colored_print' id='4422456560'>
mock_smart_input = <MagicMock name='smart_input' id='4428093616'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    def test_collect_sync_patterns_add_new(self, mock_colored_print, mock_smart_input):
        """ÊµãËØï7: _collect_sync_patternsÊñπÊ≥ïÊ∑ªÂä†Êñ∞Ê®°Âºè"""
        log_test_output("ÊµãËØï7: _collect_sync_patternsÊ∑ªÂä†Êñ∞Ê®°Âºè", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
            config_manager = config_manager.main.EnhancedConfigManager()
    
            # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Ôºà‰øùÁïôÈªòËÆ§ÂÄºÔºåÊ∑ªÂä†Êñ∞ÂÄºÔºâ
            mock_smart_input.side_effect = [
                "*.py",     # ‰øùÁïôÁ¨¨‰∏Ä‰∏™ÈªòËÆ§ÂÄº
                "*.ts",     # Ê∑ªÂä†Êñ∞ÁöÑÊ®°Âºè
                "*.vue",    # Ê∑ªÂä†Êñ∞ÁöÑÊ®°Âºè
                ""          # ÂÆåÊàêÈÖçÁΩÆ
            ]
    
            # Ë∞ÉÁî®_collect_sync_patternsÊñπÊ≥ï
            result = config_manager._collect_sync_patterns(
                "ÂåÖÂê´Ê®°Âºè",
                defaults=['*.py']
            )
    
            # È™åËØÅÁªìÊûú
            self.assertIsInstance(result, list)
            self.assertEqual(len(result), 3)
            self.assertIn('*.py', result)
            self.assertIn('*.ts', result)
            self.assertIn('*.vue', result)
    
            log_test_output("‚úÖ _collect_sync_patternsÊ≠£Á°ÆÊ∑ªÂä†Êñ∞Ê®°Âºè", "SUCCESS")
    
        except Exception as e:
>           self.fail(f"ÊµãËØï_collect_sync_patternsÊ∑ªÂä†Êñ∞Ê®°ÂºèÂ§±Ë¥•: {str(e)}")
E           AssertionError: ÊµãËØï_collect_sync_patternsÊ∑ªÂä†Êñ∞Ê®°ÂºèÂ§±Ë¥•: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:301: AssertionError
----------------------------- Captured stdout call -----------------------------
‚ÑπÔ∏è ÂºÄÂßãÊµãËØï: TestSyncConfigUIEnhancement
‚ÑπÔ∏è ÊµãËØï7: _collect_sync_patternsÊ∑ªÂä†Êñ∞Ê®°Âºè
‚ÑπÔ∏è ÂÆåÊàêÊµãËØï: TestSyncConfigUIEnhancement
_____ TestSyncConfigUIEnhancement.test_collect_sync_patterns_method_exists _____

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_collect_sync_patterns_method_exists>

    def test_collect_sync_patterns_method_exists(self):
        """ÊµãËØï2: _collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®‰∏îÂèØË∞ÉÁî®"""
        log_test_output("ÊµãËØï2: _collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®ÊÄß", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
>           config_manager = config_manager.main.EnhancedConfigManager()
E           UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:75: UnboundLocalError

During handling of the above exception, another exception occurred:

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_collect_sync_patterns_method_exists>

    def test_collect_sync_patterns_method_exists(self):
        """ÊµãËØï2: _collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®‰∏îÂèØË∞ÉÁî®"""
        log_test_output("ÊµãËØï2: _collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®ÊÄß", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
            config_manager = config_manager.main.EnhancedConfigManager()
    
            # È™åËØÅÊñπÊ≥ïÂ≠òÂú®
            self.assertTrue(hasattr(config_manager, '_collect_sync_patterns'))
            self.assertTrue(callable(getattr(config_manager, '_collect_sync_patterns')))
    
            log_test_output("‚úÖ _collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®‰∏îÂèØË∞ÉÁî®", "SUCCESS")
    
        except ImportError as e:
            self.fail(f"Êó†Ê≥ïÂØºÂÖ•EnhancedConfigManager: {str(e)}")
        except Exception as e:
>           self.fail(f"ÊµãËØï_collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®ÊÄßÂ§±Ë¥•: {str(e)}")
E           AssertionError: ÊµãËØï_collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®ÊÄßÂ§±Ë¥•: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:86: AssertionError
----------------------------- Captured stdout call -----------------------------
‚ÑπÔ∏è ÂºÄÂßãÊµãËØï: TestSyncConfigUIEnhancement
‚ÑπÔ∏è ÊµãËØï2: _collect_sync_patternsÊñπÊ≥ïÂ≠òÂú®ÊÄß
‚ÑπÔ∏è ÂÆåÊàêÊµãËØï: TestSyncConfigUIEnhancement
_____ TestSyncConfigUIEnhancement.test_collect_sync_patterns_with_defaults _____

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_collect_sync_patterns_with_defaults>
mock_colored_print = <MagicMock name='colored_print' id='4428111776'>
mock_smart_input = <MagicMock name='smart_input' id='4428207824'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    def test_collect_sync_patterns_with_defaults(self, mock_colored_print, mock_smart_input):
        """ÊµãËØï6: _collect_sync_patternsÊñπÊ≥ïÂ§ÑÁêÜÈªòËÆ§ÂÄº"""
        log_test_output("ÊµãËØï6: _collect_sync_patternsÂ§ÑÁêÜÈªòËÆ§ÂÄº", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
>           config_manager = config_manager.main.EnhancedConfigManager()
E           UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:239: UnboundLocalError

During handling of the above exception, another exception occurred:

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_collect_sync_patterns_with_defaults>
mock_colored_print = <MagicMock name='colored_print' id='4428111776'>
mock_smart_input = <MagicMock name='smart_input' id='4428207824'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    def test_collect_sync_patterns_with_defaults(self, mock_colored_print, mock_smart_input):
        """ÊµãËØï6: _collect_sync_patternsÊñπÊ≥ïÂ§ÑÁêÜÈªòËÆ§ÂÄº"""
        log_test_output("ÊµãËØï6: _collect_sync_patternsÂ§ÑÁêÜÈªòËÆ§ÂÄº", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
            config_manager = config_manager.main.EnhancedConfigManager()
    
            # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Ôºà‰øùÁïôÈªòËÆ§ÂÄºÔºå‰∏çÊ∑ªÂä†Êñ∞ÂÄºÔºâ
            mock_smart_input.side_effect = [
                "*.py",  # ‰øùÁïôÁ¨¨‰∏Ä‰∏™ÈªòËÆ§ÂÄº
                "*.js",  # ‰øùÁïôÁ¨¨‰∫å‰∏™ÈªòËÆ§ÂÄº
                ""       # ÂÆåÊàêÈÖçÁΩÆ
            ]
    
            # Ë∞ÉÁî®_collect_sync_patternsÊñπÊ≥ï
            result = config_manager._collect_sync_patterns(
                "ÂåÖÂê´Ê®°Âºè",
                defaults=['*.py', '*.js']
            )
    
            # È™åËØÅÁªìÊûú
            self.assertIsInstance(result, list)
            self.assertEqual(len(result), 2)
            self.assertIn('*.py', result)
            self.assertIn('*.js', result)
    
            log_test_output("‚úÖ _collect_sync_patternsÊ≠£Á°ÆÂ§ÑÁêÜÈªòËÆ§ÂÄº", "SUCCESS")
    
        except Exception as e:
>           self.fail(f"ÊµãËØï_collect_sync_patternsÂ§ÑÁêÜÈªòËÆ§ÂÄºÂ§±Ë¥•: {str(e)}")
E           AssertionError: ÊµãËØï_collect_sync_patternsÂ§ÑÁêÜÈªòËÆ§ÂÄºÂ§±Ë¥•: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:263: AssertionError
----------------------------- Captured stdout call -----------------------------
‚ÑπÔ∏è ÂºÄÂßãÊµãËØï: TestSyncConfigUIEnhancement
‚ÑπÔ∏è ÊµãËØï6: _collect_sync_patternsÂ§ÑÁêÜÈªòËÆ§ÂÄº
‚ÑπÔ∏è ÂÆåÊàêÊµãËØï: TestSyncConfigUIEnhancement
___________ TestSyncConfigUIEnhancement.test_configure_sync_disabled ___________

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_configure_sync_disabled>
mock_colored_print = <MagicMock name='colored_print' id='4428290656'>
mock_smart_input = <MagicMock name='smart_input' id='4428268064'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    def test_configure_sync_disabled(self, mock_colored_print, mock_smart_input):
        """ÊµãËØï3: Áî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®Ëá™Âä®ÂêåÊ≠•"""
        log_test_output("ÊµãËØï3: Áî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®Ëá™Âä®ÂêåÊ≠•", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
>           config_manager = config_manager.main.EnhancedConfigManager()
E           UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:98: UnboundLocalError

During handling of the above exception, another exception occurred:

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_configure_sync_disabled>
mock_colored_print = <MagicMock name='colored_print' id='4428290656'>
mock_smart_input = <MagicMock name='smart_input' id='4428268064'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    def test_configure_sync_disabled(self, mock_colored_print, mock_smart_input):
        """ÊµãËØï3: Áî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®Ëá™Âä®ÂêåÊ≠•"""
        log_test_output("ÊµãËØï3: Áî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®Ëá™Âä®ÂêåÊ≠•", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
            config_manager = config_manager.main.EnhancedConfigManager()
    
            # Ê®°ÊãüÁî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®ÂêåÊ≠•
            mock_smart_input.return_value = "2"
    
            # Ë∞ÉÁî®_configure_syncÊñπÊ≥ï
            result = config_manager._configure_sync()
    
            # È™åËØÅÁªìÊûú
            self.assertIsNone(result)
    
            # È™åËØÅsmart_inputË¢´Ë∞ÉÁî®
            mock_smart_input.assert_called_once()
    
            log_test_output("‚úÖ Áî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®ÂêåÊ≠•Êó∂Ê≠£Á°ÆËøîÂõûNone", "SUCCESS")
    
        except Exception as e:
>           self.fail(f"ÊµãËØïÁî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®ÂêåÊ≠•Â§±Ë¥•: {str(e)}")
E           AssertionError: ÊµãËØïÁî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®ÂêåÊ≠•Â§±Ë¥•: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:115: AssertionError
----------------------------- Captured stdout call -----------------------------
‚ÑπÔ∏è ÂºÄÂßãÊµãËØï: TestSyncConfigUIEnhancement
‚ÑπÔ∏è ÊµãËØï3: Áî®Êà∑ÈÄâÊã©‰∏çÂêØÁî®Ëá™Âä®ÂêåÊ≠•
‚ÑπÔ∏è ÂÆåÊàêÊµãËØï: TestSyncConfigUIEnhancement
_____ TestSyncConfigUIEnhancement.test_configure_sync_enabled_full_config ______

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_configure_sync_enabled_full_config>
mock_collect_patterns = <MagicMock name='_collect_sync_patterns' id='4428281360'>
mock_colored_print = <MagicMock name='colored_print' id='4428206336'>
mock_smart_input = <MagicMock name='smart_input' id='4428385344'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    @patch('enhanced_config_manager.EnhancedConfigManager._collect_sync_patterns')
    def test_configure_sync_enabled_full_config(self, mock_collect_patterns, mock_colored_print, mock_smart_input):
        """ÊµãËØï4: Áî®Êà∑ÂêØÁî®Ëá™Âä®ÂêåÊ≠•Âπ∂ÂÆåÊï¥ÈÖçÁΩÆ"""
        log_test_output("ÊµãËØï4: Áî®Êà∑ÂêØÁî®Ëá™Âä®ÂêåÊ≠•Âπ∂ÂÆåÊï¥ÈÖçÁΩÆ", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
>           config_manager = config_manager.main.EnhancedConfigManager()
E           UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:128: UnboundLocalError

During handling of the above exception, another exception occurred:

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_configure_sync_enabled_full_config>
mock_collect_patterns = <MagicMock name='_collect_sync_patterns' id='4428281360'>
mock_colored_print = <MagicMock name='colored_print' id='4428206336'>
mock_smart_input = <MagicMock name='smart_input' id='4428385344'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    @patch('enhanced_config_manager.EnhancedConfigManager._collect_sync_patterns')
    def test_configure_sync_enabled_full_config(self, mock_collect_patterns, mock_colored_print, mock_smart_input):
        """ÊµãËØï4: Áî®Êà∑ÂêØÁî®Ëá™Âä®ÂêåÊ≠•Âπ∂ÂÆåÊï¥ÈÖçÁΩÆ"""
        log_test_output("ÊµãËØï4: Áî®Êà∑ÂêØÁî®Ëá™Âä®ÂêåÊ≠•Âπ∂ÂÆåÊï¥ÈÖçÁΩÆ", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
            config_manager = config_manager.main.EnhancedConfigManager()
    
            # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Â∫èÂàó
            mock_smart_input.side_effect = [
                "1",  # ÂêØÁî®Ëá™Âä®ÂêåÊ≠•
                "/home/Code",  # ËøúÁ®ãÂ∑•‰ΩúÁõÆÂΩï
                "8021",  # FTPÁ´ØÂè£
                "ftpuser",  # FTPÁî®Êà∑Âêç
                "mypassword",  # FTPÂØÜÁ†Å
                "/local/workspace"  # Êú¨Âú∞Â∑•‰ΩúÁõÆÂΩï
            ]
    
            # Ê®°Êãücollect_sync_patternsËøîÂõûÂÄº
            mock_collect_patterns.side_effect = [
                ['*.py', '*.js', '*.md'],  # ÂåÖÂê´Ê®°Âºè
                ['*.pyc', '__pycache__', '.git']  # ÊéíÈô§Ê®°Âºè
            ]
    
            # Ë∞ÉÁî®_configure_syncÊñπÊ≥ï
            result = config_manager._configure_sync()
    
            # È™åËØÅÁªìÊûú
            self.assertIsNotNone(result)
            self.assertIsInstance(result, dict)
            self.assertTrue(result.get('enabled'))
            self.assertEqual(result.get('remote_workspace'), '/home/Code')
            self.assertEqual(result.get('ftp_port'), '8021')
            self.assertEqual(result.get('ftp_user'), 'ftpuser')
            self.assertEqual(result.get('ftp_password'), 'mypassword')
            self.assertEqual(result.get('local_workspace'), '/local/workspace')
            self.assertEqual(result.get('include_patterns'), ['*.py', '*.js', '*.md'])
            self.assertEqual(result.get('exclude_patterns'), ['*.pyc', '__pycache__', '.git'])
    
            # È™åËØÅsmart_inputË¢´Ê≠£Á°ÆË∞ÉÁî®
            self.assertEqual(mock_smart_input.call_count, 6)
    
            # È™åËØÅ_collect_sync_patternsË¢´Ë∞ÉÁî®‰∏§Ê¨°
            self.assertEqual(mock_collect_patterns.call_count, 2)
    
            log_test_output("‚úÖ Áî®Êà∑ÂêØÁî®ÂêåÊ≠•Êó∂Ê≠£Á°ÆÊî∂ÈõÜÊâÄÊúâÈÖçÁΩÆ", "SUCCESS")
    
        except Exception as e:
>           self.fail(f"ÊµãËØïÁî®Êà∑ÂêØÁî®ÂêåÊ≠•ÈÖçÁΩÆÂ§±Ë¥•: {str(e)}")
E           AssertionError: ÊµãËØïÁî®Êà∑ÂêØÁî®ÂêåÊ≠•ÈÖçÁΩÆÂ§±Ë¥•: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:170: AssertionError
----------------------------- Captured stdout call -----------------------------
‚ÑπÔ∏è ÂºÄÂßãÊµãËØï: TestSyncConfigUIEnhancement
‚ÑπÔ∏è ÊµãËØï4: Áî®Êà∑ÂêØÁî®Ëá™Âä®ÂêåÊ≠•Âπ∂ÂÆåÊï¥ÈÖçÁΩÆ
‚ÑπÔ∏è ÂÆåÊàêÊµãËØï: TestSyncConfigUIEnhancement
________ TestSyncConfigUIEnhancement.test_configure_sync_with_defaults _________

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_configure_sync_with_defaults>
mock_collect_patterns = <MagicMock name='_collect_sync_patterns' id='4428282320'>
mock_colored_print = <MagicMock name='colored_print' id='4428271376'>
mock_smart_input = <MagicMock name='smart_input' id='4428435952'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    @patch('enhanced_config_manager.EnhancedConfigManager._collect_sync_patterns')
    def test_configure_sync_with_defaults(self, mock_collect_patterns, mock_colored_print, mock_smart_input):
        """ÊµãËØï5: ‰ΩøÁî®ÈªòËÆ§ÂÄºÈÖçÁΩÆËá™Âä®ÂêåÊ≠•"""
        log_test_output("ÊµãËØï5: ‰ΩøÁî®ÈªòËÆ§ÂÄºÈÖçÁΩÆËá™Âä®ÂêåÊ≠•", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
>           config_manager = config_manager.main.EnhancedConfigManager()
E           UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:183: UnboundLocalError

During handling of the above exception, another exception occurred:

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_configure_sync_with_defaults>
mock_collect_patterns = <MagicMock name='_collect_sync_patterns' id='4428282320'>
mock_colored_print = <MagicMock name='colored_print' id='4428271376'>
mock_smart_input = <MagicMock name='smart_input' id='4428435952'>

    @patch('enhanced_config_manager.EnhancedConfigManager.smart_input')
    @patch('enhanced_config_manager.EnhancedConfigManager.colored_print')
    @patch('enhanced_config_manager.EnhancedConfigManager._collect_sync_patterns')
    def test_configure_sync_with_defaults(self, mock_collect_patterns, mock_colored_print, mock_smart_input):
        """ÊµãËØï5: ‰ΩøÁî®ÈªòËÆ§ÂÄºÈÖçÁΩÆËá™Âä®ÂêåÊ≠•"""
        log_test_output("ÊµãËØï5: ‰ΩøÁî®ÈªòËÆ§ÂÄºÈÖçÁΩÆËá™Âä®ÂêåÊ≠•", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
            config_manager = config_manager.main.EnhancedConfigManager()
    
            # ÂáÜÂ§áÈªòËÆ§ÈÖçÁΩÆ
            defaults = {
                'enabled': True,
                'remote_workspace': '/test/workspace',
                'ftp_port': 9021,
                'ftp_user': 'testuser',
                'ftp_password': 'testpassword',
                'local_workspace': '/test/local',
                'include_patterns': ['*.test'],
                'exclude_patterns': ['*.temp']
            }
    
            # Ê®°ÊãüÁî®Êà∑ËæìÂÖ•Â∫èÂàóÔºà‰ΩøÁî®ÈªòËÆ§ÂÄºÔºâ
            mock_smart_input.side_effect = [
                "1",  # ÂêØÁî®Ëá™Âä®ÂêåÊ≠•
                "/test/workspace",  # ËøúÁ®ãÂ∑•‰ΩúÁõÆÂΩïÔºà‰ΩøÁî®ÈªòËÆ§ÂÄºÔºâ
                "9021",  # FTPÁ´ØÂè£Ôºà‰ΩøÁî®ÈªòËÆ§ÂÄºÔºâ
                "testuser",  # FTPÁî®Êà∑ÂêçÔºà‰ΩøÁî®ÈªòËÆ§ÂÄºÔºâ
                "testpassword",  # FTPÂØÜÁ†ÅÔºà‰ΩøÁî®ÈªòËÆ§ÂÄºÔºâ
                "/test/local"  # Êú¨Âú∞Â∑•‰ΩúÁõÆÂΩïÔºà‰ΩøÁî®ÈªòËÆ§ÂÄºÔºâ
            ]
    
            # Ê®°Êãücollect_sync_patternsËøîÂõûÈªòËÆ§ÂÄº
            mock_collect_patterns.side_effect = [
                ['*.test'],  # ÂåÖÂê´Ê®°Âºè
                ['*.temp']   # ÊéíÈô§Ê®°Âºè
            ]
    
            # Ë∞ÉÁî®_configure_syncÊñπÊ≥ï
            result = config_manager._configure_sync(defaults)
    
            # È™åËØÅÁªìÊûú
            self.assertIsNotNone(result)
            self.assertEqual(result.get('remote_workspace'), '/test/workspace')
            self.assertEqual(result.get('ftp_port'), '9021')
            self.assertEqual(result.get('ftp_user'), 'testuser')
            self.assertEqual(result.get('ftp_password'), 'testpassword')
            self.assertEqual(result.get('local_workspace'), '/test/local')
    
            log_test_output("‚úÖ ÈªòËÆ§ÂÄºÈÖçÁΩÆÊ≠£Á°ÆÂ∫îÁî®", "SUCCESS")
    
        except Exception as e:
>           self.fail(f"ÊµãËØïÈªòËÆ§ÂÄºÈÖçÁΩÆÂ§±Ë¥•: {str(e)}")
E           AssertionError: ÊµãËØïÈªòËÆ§ÂÄºÈÖçÁΩÆÂ§±Ë¥•: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:227: AssertionError
----------------------------- Captured stdout call -----------------------------
‚ÑπÔ∏è ÂºÄÂßãÊµãËØï: TestSyncConfigUIEnhancement
‚ÑπÔ∏è ÊµãËØï5: ‰ΩøÁî®ÈªòËÆ§ÂÄºÈÖçÁΩÆËá™Âä®ÂêåÊ≠•
‚ÑπÔ∏è ÂÆåÊàêÊµãËØï: TestSyncConfigUIEnhancement
__________ TestSyncConfigUIEnhancement.test_guided_setup_integration ___________

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_guided_setup_integration>
mock_guided_setup = <MagicMock name='guided_setup' id='4428395808'>

    @patch('enhanced_config_manager.EnhancedConfigManager.guided_setup')
    def test_guided_setup_integration(self, mock_guided_setup):
        """ÊµãËØï8: guided_setupÈõÜÊàêËá™Âä®ÂêåÊ≠•ÈÖçÁΩÆ"""
        log_test_output("ÊµãËØï8: guided_setupÈõÜÊàêËá™Âä®ÂêåÊ≠•ÈÖçÁΩÆ", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
>           config_manager = config_manager.main.EnhancedConfigManager()
E           UnboundLocalError: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:312: UnboundLocalError

During handling of the above exception, another exception occurred:

self = <test_sync_config_ui_enhancement.TestSyncConfigUIEnhancement testMethod=test_guided_setup_integration>
mock_guided_setup = <MagicMock name='guided_setup' id='4428395808'>

    @patch('enhanced_config_manager.EnhancedConfigManager.guided_setup')
    def test_guided_setup_integration(self, mock_guided_setup):
        """ÊµãËØï8: guided_setupÈõÜÊàêËá™Âä®ÂêåÊ≠•ÈÖçÁΩÆ"""
        log_test_output("ÊµãËØï8: guided_setupÈõÜÊàêËá™Âä®ÂêåÊ≠•ÈÖçÁΩÆ", "INFO")
    
        try:
            from config_manager.main import EnhancedConfigManager
    
            # ÂàõÂª∫ÈÖçÁΩÆÁÆ°ÁêÜÂô®ÂÆû‰æã
            config_manager = config_manager.main.EnhancedConfigManager()
    
            # Ê®°Êãüguided_setupËøîÂõûÂÄº
            mock_guided_setup.return_value = ("test_server", {
                'connection_type': 'ssh',
                'host': 'test.example.com',
                'username': 'testuser',
                'docker_enabled': True,
                'docker_config': {},
                'auto_sync_enabled': True,
                'sync_config': {
                    'enabled': True,
                    'remote_workspace': '/home/Code',
                    'ftp_port': '8021',
                    'ftp_user': 'ftpuser',
                    'ftp_password': 'syncpassword'
                }
            })
    
            # Ë∞ÉÁî®guided_setupÊñπÊ≥ï
            result = config_manager.guided_setup()
    
            # È™åËØÅÁªìÊûú
            self.assertIsNotNone(result)
            self.assertEqual(len(result), 2)
    
            server_name, config = result
            self.assertEqual(server_name, "test_server")
            self.assertIn('sync_config', config)
            self.assertTrue(config.get('auto_sync_enabled'))
    
            log_test_output("‚úÖ guided_setupÊ≠£Á°ÆÈõÜÊàêËá™Âä®ÂêåÊ≠•ÈÖçÁΩÆ", "SUCCESS")
    
        except Exception as e:
>           self.fail(f"ÊµãËØïguided_setupÈõÜÊàêÂ§±Ë¥•: {str(e)}")
E           AssertionError: ÊµãËØïguided_setupÈõÜÊàêÂ§±Ë¥•: local variable 'config_manager' referenced before assignment

tests/tool_sync_config/test_sync_config_ui_enhancement.py:346: AssertionError
----------------------------- Captured stdout call -----------------------------
‚ÑπÔ∏è ÂºÄÂßãÊµãËØï: TestSyncConfigUIEnhancement
‚ÑπÔ∏è ÊµãËØï8: guided_setupÈõÜÊàêËá™Âä®ÂêåÊ≠•ÈÖçÁΩÆ
‚ÑπÔ∏è ÂÆåÊàêÊµãËØï: TestSyncConfigUIEnhancement
____________________ test_interactive_update_server_config _____________________

    def test_interactive_update_server_config():
        # ÂÜôÂÖ•ÂàùÂßãÈÖçÁΩÆ
        with open(TEST_CONFIG_PATH, 'w', encoding='utf-8') as f:
            yaml.safe_dump(INIT_CONFIG, f, allow_unicode=True)
        # Ëá™Âä®Âåñ‰∫§‰∫í
        with patch("builtins.input", side_effect=MOCK_INPUTS):
            manager = EnhancedConfigManager(config_path=TEST_CONFIG_PATH, force_interactive=True)
            manager.guided_setup(edit_server='cpu_221')
        # Ê†°È™åÈÖçÁΩÆÂÜÖÂÆπ
        actual = load_yaml(TEST_CONFIG_PATH)
        expected = load_yaml(EXPECTED_CONFIG_PATH)
>       assert actual == expected, f"ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥\nÂÆûÈôÖ: {actual}\nÈ¢ÑÊúü: {expected}"
E       AssertionError: ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥
E         ÂÆûÈôÖ: {'servers': {'cpu_221': {}}}
E         È¢ÑÊúü: {'servers': {'cpu_221': {'host': '10.0.0.221', 'username': 'root', 'port': 22, 'docker_enabled': False, 'docker_config': {}, 'auto_sync_enabled': False, 'sync_config': {}}}}
E       assert {'servers': {'cpu_221': {}}} == {'servers': {...0.221', ...}}}
E         
E         Differing items:
E         {'servers': {'cpu_221': {}}} != {'servers': {'cpu_221': {'auto_sync_enabled': False, 'docker_config': {}, 'docker_enabled': False, 'host': '10.0.0.221', ...}}}
E         
E         Full diff:
E           {
E               'servers': {...
E         
E         ...Full output truncated (13 lines hidden), use '-vv' to show

tests/tool_update_server_config/test_interactive_update_server_config.py:60: AssertionError
________________ test_interactive_update_server_config_prefill _________________

    def test_interactive_update_server_config_prefill():
        # ÂÜôÂÖ•ÂàùÂßãÈÖçÁΩÆ
        with open(TEST_CONFIG_PATH, 'w', encoding='utf-8') as f:
            yaml.safe_dump(INIT_CONFIG, f, allow_unicode=True)
        # È¢ÑÂ°´ÂèÇÊï∞
        prefill = {
            'name': 'hg225',
            'host': '192.168.1.226',  # ‰øÆÊîπÂêéÁöÑhost
            'username': 'admin',
        }
        with patch("builtins.input", side_effect=MOCK_INPUTS):
            manager = EnhancedConfigManager(config_path=TEST_CONFIG_PATH, force_interactive=True)
            manager.guided_setup(edit_server='hg225', prefill=prefill)
        # Ê†°È™åÈÖçÁΩÆÂÜÖÂÆπ
        actual = load_yaml(TEST_CONFIG_PATH)
        expected = load_yaml(EXPECTED_CONFIG_PATH)
>       assert actual == expected, f"ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥\nÂÆûÈôÖ: {actual}\nÈ¢ÑÊúü: {expected}"
E       AssertionError: ÈÖçÁΩÆÂÜÖÂÆπ‰∏ç‰∏ÄËá¥
E         ÂÆûÈôÖ: {'servers': {'hg225': {'host': '192.168.1.226', 'name': 'hg225', 'username': 'admin'}}}
E         È¢ÑÊúü: {'servers': {'hg225': {'host': '192.168.1.226', 'username': 'admin', 'port': 22, 'docker_enabled': False, 'docker_config': {}, 'auto_sync_enabled': False, 'sync_config': {}}}}
E       assert {'servers': {...e': 'admin'}}} == {'servers': {...1.226', ...}}}
E         
E         Differing items:
E         {'servers': {'hg225': {'host': '192.168.1.226', 'name': 'hg225', 'username': 'admin'}}} != {'servers': {'hg225': {'auto_sync_enabled': False, 'docker_config': {}, 'docker_enabled': False, 'host': '192.168.1.226', ...}}}
E         
E         Full diff:
E           {
E               'servers': {...
E         
E         ...Full output truncated (12 lines hidden), use '-vv' to show

tests/tool_update_server_config/test_interactive_update_server_config_prefill.py:65: AssertionError
=========================== short test summary info ============================
FAILED python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py::TestInteractiveStartupRequirement::test_create_server_config_must_start_interactive_interface
FAILED python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py::TestInteractiveStartupRequirement::test_interactive_startup_failure_diagnosis
FAILED python/tests/tool_connect_server/test_fix_interactive_startup_requirement_20241222.py::TestInteractiveStartupRequirement::test_interactive_startup_with_minimal_params
FAILED python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py::TestUserVisibleInteraction::test_interactive_interface_accessibility
FAILED python/tests/tool_connect_server/test_fix_user_visible_interaction_20241222.py::TestUserVisibleInteraction::test_terminal_window_creation_on_macos
FAILED python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_guided_setup_docker_server_full_automation
FAILED python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_guided_setup_relay_server_full_automation
FAILED python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_guided_setup_ssh_server_full_automation
FAILED python/tests/tool_connect_server/test_fully_automated_interactive.py::TestFullyAutomatedInteractive::test_smart_input_error_recovery_automation
FAILED python/tests/tool_connect_server/test_fully_automated_interactive.py::TestInputValidationAutomation::test_hostname_validation_automation
FAILED python/tests/tool_connect_server/test_fully_automated_interactive.py::TestInputValidationAutomation::test_port_validation_automation
FAILED python/tests/tool_connect_server/test_mcp_tools.py::TestConfigurationConsistency::test_config_directory_consistency
FAILED python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_main_entry_file
FAILED python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageIntegrity::test_required_python_files
FAILED python/tests/tool_connect_server/test_package_integrity.py::TestNPMPackageInstallation::test_npm_pack_success
FAILED python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_ensure_config_exists_preserves_user_config
FAILED python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_get_existing_servers_preserves_user_modifications
FAILED python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_modified_example_server_detection
FAILED python/tests/tool_connect_server/test_regression_prevention.py::TestConfigurationPersistenceRegression::test_npm_installation_protection
FAILED python/tests/tool_connect_server/test_simple_automated_demo.py::TestSimpleAutomationDemo::test_multiple_validation_types
FAILED python/tests/tool_connect_server/test_simple_automated_demo.py::TestSimpleAutomationDemo::test_smart_input_basic_automation
FAILED python/tests/tool_connect_server/test_simple_automated_demo.py::TestSimpleAutomationDemo::test_smart_input_error_recovery_automation
FAILED python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_batch_server_creation
FAILED python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_completely_headless_operation
FAILED python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_completely_silent_mcp_setup
FAILED python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_mock_all_interactions_completely
FAILED python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_smart_input_with_defaults
FAILED python/tests/tool_connect_server/test_zero_interaction_demo.py::TestZeroInteractionDemo::test_validation_with_auto_retry
FAILED test_interactive_config.py::test_force_interactive - NameError: name '...
FAILED tests/tool_add_server_config/test_interactive_create_server_config.py::test_interactive_create_server_config
FAILED tests/tool_add_server_config/test_interactive_create_server_config_prefill.py::test_interactive_create_server_config_prefill
FAILED tests/tool_delete_server_config/test_fix_config_ux_and_prefill_bug.py::TestConfigUXPrefillFix::test_guided_setup_for_relay_server
FAILED tests/tool_delete_server_config/test_fix_config_ux_and_prefill_bug.py::TestConfigUXPrefillFix::test_update_relay_server_with_prefill_issues
FAILED tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_reproduce_original_issue
FAILED tests/tool_execute_command/test_fix_example_mcp_testing_20240622.py::TestMCPToolingFramework::test_integration_with_other_components
FAILED tests/tool_execute_command/test_fix_mcp_restart_and_new_code_loading_20241222.py::TestMCPRestartAndNewCodeLoading::test_new_update_server_config_logic_loading
FAILED tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_regression_directory_structure
FAILED tests/tool_get_server_status/test_fix_quality_assurance_rules_20240622.py::QualityAssuranceRulesTest::test_regression_test_naming_convention
FAILED tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPSilentConfigRegression::test_constructor_without_force_interactive
FAILED tests/tool_list_servers/test_mcp_silent_config_regression.py::TestMCPSilentConfigRegression::test_smart_input_detailed_error_messages
FAILED tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_collect_sync_patterns_add_new
FAILED tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_collect_sync_patterns_method_exists
FAILED tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_collect_sync_patterns_with_defaults
FAILED tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_configure_sync_disabled
FAILED tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_configure_sync_enabled_full_config
FAILED tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_configure_sync_with_defaults
FAILED tests/tool_sync_config/test_sync_config_ui_enhancement.py::TestSyncConfigUIEnhancement::test_guided_setup_integration
FAILED tests/tool_update_server_config/test_interactive_update_server_config.py::test_interactive_update_server_config
FAILED tests/tool_update_server_config/test_interactive_update_server_config_prefill.py::test_interactive_update_server_config_prefill
=========== 49 failed, 157 passed, 2 skipped, 26 warnings in 51.93s ============
