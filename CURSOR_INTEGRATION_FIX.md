# Cursor MCP é›†æˆä¿®å¤æ–‡æ¡£

## é—®é¢˜æè¿°

åœ¨å°è¯•å°† remote-terminal-mcp æœåŠ¡å™¨é›†æˆåˆ° Cursor ç¼–è¾‘å™¨æ—¶ï¼Œé‡åˆ°äº†ä»¥ä¸‹é—®é¢˜ï¼š

- Cursor ä¸­æ˜¾ç¤º `remote-terminal` çŠ¶æ€ä¸ºçº¢è‰² ğŸ”´
- æ˜¾ç¤º `0 tools enabled`
- MCP Logs ä¸­å‡ºç° `No server info found` é”™è¯¯

## æ ¹æœ¬åŸå› åˆ†æ

é€šè¿‡ç³»ç»Ÿæ€§è°ƒè¯•ï¼Œå‘ç°äº†ä¸‰ä¸ªå…³é”®é—®é¢˜ï¼š

### 1. SSH Manager æ–¹æ³•å…¼å®¹æ€§é—®é¢˜
- **é—®é¢˜**: `mcp_server.py` ä¸­è°ƒç”¨äº†ä¸å­˜åœ¨çš„æ–¹æ³•å¦‚ `list_tools()`, `execute_tool()`
- **æ ¹å› **: SSH Manager å®é™…æ–¹æ³•ä¸º `list_servers()`, `execute_command()` ç­‰
- **å½±å“**: å¯¼è‡´ AttributeError å´©æºƒ

### 2. MCP åè®®ç‰ˆæœ¬ä¸åŒ¹é…
- **é—®é¢˜**: Cursor è¯·æ±‚åè®®ç‰ˆæœ¬ `2025-03-26`ï¼ŒæœåŠ¡å™¨è¿”å› `2024-11-05`
- **æ ¹å› **: ç¡¬ç¼–ç çš„åè®®ç‰ˆæœ¬ä¸ Cursor æœŸæœ›ä¸ç¬¦
- **å½±å“**: åè®®æ¡æ‰‹å¤±è´¥

### 3. é€šçŸ¥å¤„ç†é”™è¯¯
- **é—®é¢˜**: `notifications/initialized` è¢«é”™è¯¯åœ°è¿”å›é”™è¯¯å“åº”
- **æ ¹å› **: é€šçŸ¥åº”è¯¥ä¸è¿”å›å“åº”ï¼Œä½†æœåŠ¡å™¨å°†å…¶ä½œä¸ºæœªçŸ¥æ–¹æ³•å¤„ç†
- **å½±å“**: å¹²æ‰° MCP åè®®é€šä¿¡

## è§£å†³æ–¹æ¡ˆ

### 1. ä¿®å¤ SSH Manager æ–¹æ³•è°ƒç”¨

**ä¿®æ”¹å‰**:
```python
# é”™è¯¯çš„æ–¹æ³•è°ƒç”¨
manager.list_tools()
manager.execute_tool()
```

**ä¿®æ”¹å**:
```python
# ä½¿ç”¨å®é™…å­˜åœ¨çš„æ–¹æ³•
manager.list_servers()
manager.execute_command(server_name, command)
manager.simple_connect(server_name)
manager.get_server_status(server_name)
```

### 2. å®ç°åŠ¨æ€åè®®ç‰ˆæœ¬åŒ¹é…

**ä¿®æ”¹å‰**:
```python
"protocolVersion": "2024-11-05"  # ç¡¬ç¼–ç ç‰ˆæœ¬
```

**ä¿®æ”¹å**:
```python
# åŠ¨æ€ä½¿ç”¨å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰ˆæœ¬
client_protocol_version = request.get('params', {}).get('protocolVersion', '2024-11-05')
"protocolVersion": client_protocol_version
```

### 3. æ­£ç¡®å¤„ç†é€šçŸ¥

**ä¿®æ”¹å‰**:
```python
# å°†é€šçŸ¥ä½œä¸ºé”™è¯¯å¤„ç†
else:
    return {"error": {"code": -1, "message": f"æœªçŸ¥æ–¹æ³•: {method}"}}
```

**ä¿®æ”¹å**:
```python
elif method == 'notifications/initialized':
    logger.info("å¤„ç†notifications/initializedé€šçŸ¥")
    return None  # é€šçŸ¥ä¸éœ€è¦å“åº”
```

### 4. ä¼˜åŒ–å¤§æ•°æ®å“åº”å¤„ç†

ä¸ºé¿å… SSH Manager è¿”å›çš„å¤§é‡æœåŠ¡å™¨é…ç½®æ•°æ®å¯¼è‡´é€šä¿¡é˜»å¡ï¼š

```python
# åªè¿”å›å…³é”®ä¿¡æ¯ï¼Œé¿å…å¤§æ•°æ®é‡
simple_servers = []
for server in servers:
    simple_servers.append({
        'name': server.get('name', ''),
        'description': server.get('description', ''),
        'connected': server.get('connected', False),
        'type': server.get('type', '')
    })
```

## æµ‹è¯•éªŒè¯

### 1. å•å…ƒæµ‹è¯•
åˆ›å»ºäº†å¤šä¸ªæµ‹è¯•è„šæœ¬éªŒè¯ä¿®å¤æ•ˆæœï¼š

- `test_cursor_compatible_v2.py`: æµå¼è¯»å–å…¼å®¹æ€§æµ‹è¯•
- `test_cursor_real_protocol.py`: å®Œæ•´ Cursor åè®®æ¨¡æ‹Ÿæµ‹è¯•

### 2. åè®®æµ‹è¯•ç»“æœ

```
ğŸš€ æµ‹è¯•çœŸå®çš„Cursor MCPåè®®...

=== 1. Cursoråˆå§‹åŒ–è¯·æ±‚ ===
âœ… åˆå§‹åŒ–æˆåŠŸ
   æœåŠ¡å™¨: remote-terminal-mcp v1.0.0-debug
   åè®®ç‰ˆæœ¬: 2025-03-26

=== 2. Cursoråˆå§‹åŒ–å®Œæˆé€šçŸ¥ ===
âœ… é€šçŸ¥å¤„ç†æˆåŠŸ

=== 3. Cursorå·¥å…·åˆ—è¡¨è¯·æ±‚ ===
âœ… è·å–åˆ° 5 ä¸ªå·¥å…·
```

### 3. Cursor é›†æˆæµ‹è¯•
- âœ… Cursor ä¸­æ˜¾ç¤ºç»¿è‰²çŠ¶æ€ ğŸŸ¢
- âœ… æ˜¾ç¤º `5 tools enabled`
- âœ… æ‰€æœ‰å·¥å…·æ­£å¸¸å¯ç”¨

## è°ƒè¯•å·¥å…·

### mcp_server_debug.py
åˆ›å»ºäº†å¸¦è¯¦ç»†æ—¥å¿—çš„è°ƒè¯•ç‰ˆæœ¬ï¼Œç‰¹æ€§åŒ…æ‹¬ï¼š

- è¯¦ç»†çš„è¯·æ±‚/å“åº”æ—¥å¿—è®°å½•
- æ–‡ä»¶å’Œæ§åˆ¶å°åŒé‡æ—¥å¿—è¾“å‡º
- å®Œæ•´çš„é”™è¯¯å †æ ˆè·Ÿè¸ª
- åè®®ç‰ˆæœ¬ä¿¡æ¯è®°å½•

### æ—¥å¿—åˆ†æ
é€šè¿‡æ—¥å¿—æ–‡ä»¶ `/tmp/mcp_server_debug.log` å¯ä»¥è¯¦ç»†è¿½è¸ªï¼š

- æ¯ä¸ªè¯·æ±‚çš„å¤„ç†è¿‡ç¨‹
- åè®®ç‰ˆæœ¬åå•†è¿‡ç¨‹
- å·¥å…·è°ƒç”¨çš„å‚æ•°å’Œç»“æœ
- é”™è¯¯å‘ç”Ÿçš„å…·ä½“ä½ç½®

## æ–‡ä»¶ç»“æ„

```
python/
â”œâ”€â”€ mcp_server.py          # ä¸»è¦ MCP æœåŠ¡å™¨ï¼ˆä¿®å¤ç‰ˆï¼‰
â”œâ”€â”€ mcp_server_debug.py    # è°ƒè¯•ç‰ˆæœ¬ï¼ˆå¸¦è¯¦ç»†æ—¥å¿—ï¼‰
â””â”€â”€ ssh_manager.py         # SSH ç®¡ç†å™¨ï¼ˆæœªä¿®æ”¹ï¼‰

tests/
â”œâ”€â”€ test_cursor_compatible_v2.py    # å…¼å®¹æ€§æµ‹è¯•
â””â”€â”€ test_cursor_real_protocol.py    # åè®®æµ‹è¯•

docs/
â”œâ”€â”€ NPM_DEBUGGING_LOG.md           # NPM è°ƒè¯•è®°å½•
â””â”€â”€ CURSOR_INTEGRATION_FIX.md      # æœ¬æ–‡æ¡£
```

## ä½¿ç”¨æ–¹æ³•

### 1. åœ¨ Cursor ä¸­é…ç½®

ä¿®æ”¹ `~/.cursor/mcp.json`:

```json
{
  "mcpServers": {
    "remote-terminal": {
      "command": "python3",
      "args": [
        "/Users/ä½ çš„ç”¨æˆ·å/Code/remote-terminal-mcp/python/mcp_server.py"
      ],
      "env": {
        "FORCE_COLOR": "true"
      }
    }
  }
}
```

### 2. è°ƒè¯•æ¨¡å¼

å¦‚éœ€è°ƒè¯•ï¼Œå¯ä½¿ç”¨è°ƒè¯•ç‰ˆæœ¬ï¼š

```json
"args": [
  "/Users/ä½ çš„ç”¨æˆ·å/Code/remote-terminal-mcp/python/mcp_server_debug.py"
]
```

### 3. éªŒè¯å®‰è£…

é‡å¯ Cursor åï¼Œåœ¨ Tools & Integrations ä¸­åº”è¯¥çœ‹åˆ°ï¼š
- `remote-terminal` æ˜¾ç¤ºç»¿è‰²çŠ¶æ€ ğŸŸ¢
- æ˜¾ç¤º `5 tools enabled`

## æŠ€æœ¯è¦ç‚¹

### MCP åè®®ç‰ˆæœ¬å…¼å®¹æ€§
- Cursor ä½¿ç”¨è¾ƒæ–°çš„åè®®ç‰ˆæœ¬ `2025-03-26`
- æœåŠ¡å™¨åº”è¯¥åŠ¨æ€é€‚é…å®¢æˆ·ç«¯ç‰ˆæœ¬
- ç‰ˆæœ¬ä¸åŒ¹é…ä¼šå¯¼è‡´æ•´ä¸ªè¿æ¥å¤±è´¥

### é€šçŸ¥ vs è¯·æ±‚çš„åŒºåˆ«
- è¯·æ±‚ (Request): éœ€è¦è¿”å›å“åº”
- é€šçŸ¥ (Notification): ä¸éœ€è¦è¿”å›å“åº”
- é”™è¯¯å¤„ç†é€šçŸ¥ä¼šå¹²æ‰°åè®®é€šä¿¡

### å¤§æ•°æ®å“åº”ä¼˜åŒ–
- SSH Manager è¿”å›çš„å®Œæ•´æœåŠ¡å™¨é…ç½®æ•°æ®é‡å·¨å¤§
- éœ€è¦æå–å…³é”®ä¿¡æ¯é¿å…é€šä¿¡é˜»å¡
- ä½¿ç”¨æµå¼è¯»å–å¤„ç†å¤§å“åº”

## åç»­ç»´æŠ¤

1. **å®šæœŸæµ‹è¯•**: ä½¿ç”¨æä¾›çš„æµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½
2. **æ—¥å¿—ç›‘æ§**: å®šæœŸæŸ¥çœ‹è°ƒè¯•æ—¥å¿—å‘ç°æ½œåœ¨é—®é¢˜
3. **åè®®æ›´æ–°**: å…³æ³¨ MCP åè®®ç‰ˆæœ¬æ›´æ–°
4. **é”™è¯¯å¤„ç†**: ç»§ç»­å®Œå–„è¾¹ç•Œæ¡ä»¶å¤„ç†

## è´¡çŒ®è€…

æ­¤æ¬¡ä¿®å¤é€šè¿‡ç³»ç»Ÿæ€§è°ƒè¯•æ–¹æ³•å®Œæˆï¼Œå±•ç¤ºäº†ï¼š
- é—®é¢˜åˆ†è§£ä¸æ ¹å› åˆ†æ
- åè®®å…¼å®¹æ€§è°ƒè¯•
- ç»“æ„åŒ–æµ‹è¯•éªŒè¯
- å®Œæ•´çš„æ–‡æ¡£è®°å½•

---

*æœ€åæ›´æ–°: 2025-06-12*
*çŠ¶æ€: âœ… ä¿®å¤å®Œæˆï¼ŒCursor é›†æˆæ­£å¸¸å·¥ä½œ* 